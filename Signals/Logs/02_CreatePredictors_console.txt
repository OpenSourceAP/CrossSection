Create Predictors Log - Started at 2025-10-14 12:23:23
================================================================================


ğŸ”„ Creating Signal Master Table: SignalMasterTable.py
============================================================
Starting SignalMasterTable.py...
Loading monthly CRSP data...
Loaded monthlyCRSP: 5153763 rows, 9 columns
Filtering for common stocks and major exchanges...
After filtering: 4047630 rows
Merging with m_aCompustat...
After Compustat merge: 4047630 rows
Adding auxiliary variables...
After adding auxiliary vars: 4047630 rows, 12 columns
Checking for IBES-CRSP linking table...
Adding IBES-CRSP link...
After IBES link merge: 4047630 rows, 14 columns
Checking for OptionMetrics-CRSP linking table...
Adding OptionMetrics-CRSP link...
After OptionMetrics link merge: 4047630 rows, 15 columns
Saving SignalMasterTable...
SignalMasterTable saved to: ../pyData/Intermediate/SignalMasterTable.parquet
Final shape: 4047630 rows, 15 columns
Head:    permno time_avail_m ticker  exchcd  ...  NYSE  tickerIBES  score  secid
0   10000   1986-01-01  OMFGA       3  ...     0               <NA>    NaN
1   10000   1986-02-01  OMFGA       3  ...     0               <NA>    NaN
2   10000   1986-03-01  OMFGA       3  ...     0               <NA>    NaN
3   10000   1986-04-01  OMFGA       3  ...     0               <NA>    NaN
4   10000   1986-05-01  OMFGA       3  ...     0               <NA>    NaN

[5 rows x 15 columns]
============================================================
âœ… Completed: SignalMasterTable.py
Execution time: 5.28 seconds


ğŸ”„ Starting: Accruals.py
============================================================
Starting Accruals.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 10 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Setting up panel data structure...
Creating lag variables...
Calculating Accruals...
Calculated Accruals for 3277150 observations
saving Accruals
Saved 3277150 rows to ../pyData/Predictors/Accruals.csv
Accruals.py completed successfully
============================================================
âœ… Completed: Accruals.py
Execution time: 1.94 seconds


ğŸ”„ Starting: AccrualsBM.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: invalid value encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
Starting AccrualsBM.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 10 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Merging with SignalMasterTable...
After merging with SignalMasterTable: 4047630 rows
Setting up panel data structure...
Calculating BM...
Creating lag variables for accruals...
Calculating tempacc...
Creating BM quintiles...
Creating accruals quintiles...
Generating AccrualsBM signal...
Calculated AccrualsBM for 220634 observations
saving AccrualsBM
Saved 220634 rows to ../pyData/Predictors/AccrualsBM.csv
AccrualsBM.py completed successfully
============================================================
âœ… Completed: AccrualsBM.py
Execution time: 4.75 seconds


ğŸ”„ Starting: AdExp.py
============================================================
Starting AdExp.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 3 columns
Merging with SignalMasterTable...
After merging with SignalMasterTable: 4047630 rows
Calculating AdExp...
Calculated AdExp for 1049020 observations
saving AdExp
Saved 1049020 rows to ../pyData/Predictors/AdExp.csv
AdExp.py completed successfully
============================================================
âœ… Completed: AdExp.py
Execution time: 1.83 seconds


ğŸ”„ Starting: AgeIPO.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/AgeIPO.py:83: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value 'nan' has dtype incompatible with bool, please explicitly cast to a compatible dtype first.
  df.loc[df["IPOdate"].isna(), "tempipo"] = np.nan
Starting AgeIPO.py...
Loading SignalMasterTable data...
Loaded SignalMasterTable: 4047630 rows, 2 columns
Merging with IPODates...
After merging with IPODates: 4047630 rows
Calculating recent IPO filter...
Calculating AgeIPO...
Applying minimum IPO firms per month filter...
Calculated AgeIPO for 353486 observations
saving AgeIPO
Saved 353486 rows to ../pyData/Predictors/AgeIPO.csv
AgeIPO.py completed successfully
============================================================
âœ… Completed: AgeIPO.py
Execution time: 1.04 seconds


ğŸ”„ Starting: AM.py
============================================================
AM predictor saved successfully
============================================================
âœ… Completed: AM.py
Execution time: 4.50 seconds


ğŸ”„ Starting: AnalystRevision.py
============================================================
Starting AnalystRevision.py...
Loading and preparing IBES data...
Prepared IBES data: 2401222 rows, 3 columns
Loading SignalMasterTable...
Loaded SignalMasterTable: 4047630 rows, 3 columns
Merging with IBES data...
After merging with IBES data: 4047630 rows
Setting up panel data (sorting by permno, time_avail_m)...
Calculating 1-month lag and AnalystRevision...
Calculated AnalystRevision for 1914316 observations
saving AnalystRevision
Saved 1914316 rows to ../pyData/Predictors/AnalystRevision.csv
AnalystRevision.py completed successfully
============================================================
âœ… Completed: AnalystRevision.py
Execution time: 1.74 seconds


ğŸ”„ Starting: AssetGrowth.py
============================================================
Starting AssetGrowth.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 4 columns
Setting up panel data (sorting by permno, time_avail_m)...
Calculating 12-month lag and AssetGrowth...
Calculated AssetGrowth for 3312699 observations
saving AssetGrowth
Saved 3312699 rows to ../pyData/Predictors/AssetGrowth.csv
AssetGrowth.py completed successfully
============================================================
âœ… Completed: AssetGrowth.py
Execution time: 1.38 seconds


ğŸ”„ Starting: Beta.py
============================================================
================================================================================
ğŸ—ï¸  Beta.py
Generating CAPM Beta predictor using direct polars-ols rolling regression
================================================================================
ğŸ“Š Loading monthly CRSP, FF, and Market data...
Loading monthlyCRSP.parquet...
Loaded CRSP: 5,153,763 monthly observations
Loading monthlyFF.parquet...
Loaded FF: 1,190 monthly observations
Loading monthlyMarket.parquet...
Loaded Market: 1,189 monthly observations
ğŸ”— Merging datasets...
After merging: 5,150,010 observations
ğŸ§® Computing CAPM Beta using direct polars-ols rolling 60-observation regressions...
Computing rolling regressions by permno using 60-observation windows...
Rolling window regression with minimum 20 observations per window
Processing 38,835 unique permnos...
Generated Beta values: 4,353,773 observations
Beta summary stats:
  Mean: 0.9936
  Std: 0.7517
  Min: -29.7167
  Max: 52.6319
ğŸ’¾ Saving Beta predictor...
saving Beta
Saved 4353773 rows to ../pyData/Predictors/Beta.csv
âœ… Beta.csv saved successfully
================================================================================
âœ… Beta.py Complete
CAPM Beta predictor generated using rolling 60-observation regression windows
================================================================================
============================================================
âœ… Completed: Beta.py
Execution time: 6.37 seconds


ğŸ”„ Starting: BetaLiquidityPS.py
============================================================
================================================================================
ğŸ—ï¸  BetaLiquidityPS.py
Generating Pastor-Stambaugh liquidity beta predictor
================================================================================
ğŸ“Š Loading monthly CRSP, FF, and Liquidity data...
Loading monthlyCRSP.parquet...
Loaded CRSP: 5,153,763 monthly observations
Loading monthlyFF.parquet...
Loaded FF: 1,190 monthly observations
Loading monthlyLiquidity.parquet...
Loaded Liquidity: 749 monthly observations
ğŸ”— Merging datasets...
After merging: 5,150,010 observations
ğŸ§® Computing Pastor-Stambaugh liquidity beta using direct polars-ols rolling 60-observation 4-factor regressions...
Computing rolling 4-factor regressions for 38,835 unique permnos...
Using 60-observation rolling windows with 36-observation minimum for each stock
Generated BetaLiquidityPS values: 3,479,410 observations
BetaLiquidityPS summary stats:
  Mean: -0.0022
  Std: 0.4733
  Min: -23.6664
  Max: 41.3530
ğŸ’¾ Saving BetaLiquidityPS predictor...
saving BetaLiquidityPS
Saved 3479410 rows to ../pyData/Predictors/BetaLiquidityPS.csv
âœ… BetaLiquidityPS.csv saved successfully
================================================================================
âœ… BetaLiquidityPS.py Complete
Pastor-Stambaugh liquidity beta predictor generated using rolling 4-factor regressions
================================================================================
============================================================
âœ… Completed: BetaLiquidityPS.py
Execution time: 10.28 seconds


ğŸ”„ Starting: BetaTailRisk.py
============================================================
================================================================================
ğŸ—ï¸  BetaTailRisk.py
Generating Tail Risk Beta predictor
================================================================================
ğŸ“Š Part 1: Creating monthly tail risk factor from daily returns...
Loading dailyCRSP.parquet...
Loaded daily CRSP: 107,662,961 daily observations
Calculating 5th percentile returns by month...
Generated monthly 5th percentiles for 1,188 months
Filtering to tail observations (bottom 5%) and calculating tail excess returns...
Filtered to 5,325,782 tail observations
Generated monthly tail risk factor for 1,188 months
Saved TailRisk.parquet
ğŸ“Š Part 2: Computing tail risk betas from monthly returns...
Loading monthlyCRSP.parquet...
Loaded monthly CRSP: 5,153,763 monthly observations
Merging with tail risk factor...
After merging: 5,153,763 observations
Computing rolling 120-month tail risk betas for 38,843 unique permnos...
Rolling 120-month regression windows with minimum 72 observations per permno
Generated BetaTailRisk values: 2,332,084 observations
BetaTailRisk summary stats:
  Mean: 0.6372
  Std: 0.7609
  Min: -96.2499
  Max: 18.9120
ğŸ’¾ Saving BetaTailRisk predictor...
saving BetaTailRisk
Saved 2332084 rows to ../pyData/Predictors/BetaTailRisk.csv
âœ… BetaTailRisk.csv saved successfully
================================================================================
âœ… BetaTailRisk.py Complete
Tail risk beta predictor generated using polars rolling window regression
================================================================================
============================================================
âœ… Completed: BetaTailRisk.py
Execution time: 7.83 seconds


ğŸ”„ Starting: BidAskSpread.py
============================================================
Starting BidAskSpread.py...
Loading corwin_schultz_spread data...
Loaded 4481622 records from ../pyData/Prep/corwin_schultz_spread.csv
After dropping missing PERMNO: 4481622 records
Processed data: 4481622 rows, 3 columns
BidAskSpread available for 4481622 observations
saving BidAskSpread
Saved 4481622 rows to ../pyData/Predictors/BidAskSpread.csv
BidAskSpread.py completed successfully
============================================================
âœ… Completed: BidAskSpread.py
Execution time: 3.21 seconds


ğŸ”„ Starting: BM.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: invalid value encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
Starting BM.py...
Loading m_aCompustat data...
Loading SignalMasterTable...
Loaded m_aCompustat: 3626811 rows
Loaded SignalMasterTable: 4047630 rows
Merging with SignalMasterTable...
After merge: 4047630 rows
Setting up panel data structure...
Creating 6-month lag for market equity...
Calculating BM signal...
Calculated BM for 2715244 observations
BM.py completed successfully
============================================================
âœ… Completed: BM.py
Execution time: 4.51 seconds


ğŸ”„ Starting: BMdec.py
============================================================
Starting BMdec predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
After deduplication: 3,626,811 observations
Loading monthlyCRSP data...
Loaded 5,153,763 CRSP observations
Merging Compustat and CRSP data...
After merge: 3,362,048 observations
Constructing BMdec signal...
Generated BMdec values for 2,996,723 observations
Saving predictor...
saving BMdec
Saved 2996723 rows to ../pyData/Predictors/BMdec.csv
BMdec predictor completed successfully!
============================================================
âœ… Completed: BMdec.py
Execution time: 2.81 seconds


ğŸ”„ Starting: BookLeverage.py
============================================================
Starting BookLeverage.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 10 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Calculating tempPS with fallback logic...
Calculating tempSE with fallback logic...
Calculating BookLeverage...
Calculated BookLeverage for 3608607 observations
saving BookLeverage
Saved 3608607 rows to ../pyData/Predictors/BookLeverage.csv
BookLeverage.py completed successfully
============================================================
âœ… Completed: BookLeverage.py
Execution time: 1.53 seconds


ğŸ”„ Starting: BrandInvest.py
============================================================
Starting BrandInvest predictor...
Loading a_aCompustat data...
Loaded 302,436 annual Compustat observations
Constructing BrandInvest signal...
Calculating brand capital accumulation...
Applying depreciation and accumulation...
Applying industry filters...
Filtered out 65,225 observations (utilities/financials)
Kept only December observations: 145,826
Expanding annual data to monthly...
After monthly expansion: 1,749,912 observations
After deduplication: 1,749,912 observations
Generated BrandInvest values for 509,616 observations
Saving predictor...
saving BrandInvest
Saved 509616 rows to ../pyData/Predictors/BrandInvest.csv
BrandInvest predictor completed successfully!
============================================================
âœ… Completed: BrandInvest.py
Execution time: 32.50 seconds


ğŸ”„ Starting: Cash.py
============================================================
Starting Cash predictor...
Loading m_QCompustat data...
Loaded 5,479,107 quarterly Compustat observations
Processing quarterly data...
After deduplication: 1,152,855 observations
Expanding quarterly data to monthly...
After monthly expansion: 3,458,565 observations
After removing overlapping announcements: 3,214,744 observations
Loading SignalMasterTable...
Loaded SignalMasterTable: 3,041,691 observations
Merging with SignalMasterTable...
After merge: 2,246,814 observations
Constructing Cash signal...
Generated Cash values for 2,246,799 observations
Saving predictor...
saving Cash
Saved 2246799 rows to ../pyData/Predictors/Cash.csv
Cash predictor completed successfully!
============================================================
âœ… Completed: Cash.py
Execution time: 3.20 seconds


ğŸ”„ Starting: CashProd.py
============================================================
Starting CashProd.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 4 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Merging with SignalMasterTable...
After merging with SignalMasterTable: 3041691 rows
Calculating CashProd...
Calculated CashProd for 3038238 observations
saving CashProd
Saved 3038238 rows to ../pyData/Predictors/CashProd.csv
CashProd.py completed successfully
============================================================
âœ… Completed: CashProd.py
Execution time: 1.98 seconds


ğŸ”„ Starting: CBOperProf.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: invalid value encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
Starting CBOperProf predictor...
Loading SignalMasterTable...
Loaded SignalMasterTable: 4,047,630 observations
Loading m_aCompustat...
Loaded m_aCompustat: 3,626,811 observations
Merging SignalMasterTable with m_aCompustat...
After merge: 4,047,630 observations
Constructing CBOperProf signal...
Generated CBOperProf values for 2,283,899 observations
Excluded 1,731,809 observations due to filtering criteria
Saving predictor...
saving CBOperProf
Saved 2283899 rows to ../pyData/Predictors/CBOperProf.csv
CBOperProf predictor completed successfully!
============================================================
âœ… Completed: CBOperProf.py
Execution time: 6.44 seconds


ğŸ”„ Starting: CF.py
============================================================
Starting CF.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 5 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Merging with SignalMasterTable...
After merging with SignalMasterTable: 4047630 rows
Calculating CF...
Calculated CF for 3038238 observations
saving CF
Saved 3038238 rows to ../pyData/Predictors/CF.csv
CF.py completed successfully
============================================================
âœ… Completed: CF.py
Execution time: 2.07 seconds


ğŸ”„ Starting: cfp.py
============================================================
Starting cfp predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
After deduplication: 3,626,811 observations
Loading SignalMasterTable...
Loaded SignalMasterTable: 4,047,630 observations
Merging with SignalMasterTable...
After merge: 3,041,691 observations
Constructing cfp signal...
Generated cfp values for 2,614,029 observations
Used oancf for 1,925,492 observations
Saving predictor...
saving cfp
Saved 2614029 rows to ../pyData/Predictors/cfp.csv
cfp predictor completed successfully!
============================================================
âœ… Completed: cfp.py
Execution time: 4.25 seconds


ğŸ”„ Starting: ChangeInRecommendation.py
============================================================
ChangeInRecommendation predictor created with 450892 observations
============================================================
âœ… Completed: ChangeInRecommendation.py
Execution time: 1.09 seconds


ğŸ”„ Starting: ChAssetTurnover.py
============================================================
ChAssetTurnover predictor saved: 2518582 observations
============================================================
âœ… Completed: ChAssetTurnover.py
Execution time: 4.08 seconds


ğŸ”„ Starting: ChEQ.py
============================================================
Starting ChEQ predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
After deduplication: 3,626,811 observations
Constructing ChEQ signal...
Generated ChEQ values for 3,060,909 observations
Saving predictor...
saving ChEQ
Saved 3060909 rows to ../pyData/Predictors/ChEQ.csv
ChEQ predictor completed successfully!
============================================================
âœ… Completed: ChEQ.py
Execution time: 0.77 seconds


ğŸ”„ Starting: ChForecastAccrual.py
============================================================
ChForecastAccrual predictor saved: 627187 observations
============================================================
âœ… Completed: ChForecastAccrual.py
Execution time: 7.02 seconds


ğŸ”„ Starting: ChInv.py
============================================================
ChInv predictor saved: 3312759 observations
============================================================
âœ… Completed: ChInv.py
Execution time: 3.15 seconds


ğŸ”„ Starting: ChInvIA.py
============================================================
ChInvIA predictor saved: 2678522 observations
============================================================
âœ… Completed: ChInvIA.py
Execution time: 5.33 seconds


ğŸ”„ Starting: ChNAnalyst.py
============================================================
saving ChNAnalyst
Saved 367659 rows to ../pyData/Predictors/ChNAnalyst.csv
============================================================
âœ… Completed: ChNAnalyst.py
Execution time: 3.34 seconds


ğŸ”„ Starting: ChNNCOA.py
============================================================
ChNNCOA predictor saved: 3263554 observations
============================================================
âœ… Completed: ChNNCOA.py
Execution time: 3.43 seconds


ğŸ”„ Starting: ChNWC.py
============================================================
Starting ChNWC predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
Constructing ChNWC signal...
Generated ChNWC values for 3,261,552 observations
Saving predictor...
saving ChNWC
Saved 3261552 rows to ../pyData/Predictors/ChNWC.csv
ChNWC predictor completed successfully!
============================================================
âœ… Completed: ChNWC.py
Execution time: 1.09 seconds


ğŸ”„ Starting: ChTax.py
============================================================
Starting ChTax predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
Loading m_QCompustat data...
Loaded 5,479,107 quarterly Compustat observations
Merging Compustat and quarterly data...
After merge: 3,266,561 observations
Constructing ChTax signal...
Generated ChTax values for 2,842,185 observations
Saving predictor...
saving ChTax
Saved 2842185 rows to ../pyData/Predictors/ChTax.csv
ChTax predictor completed successfully!
============================================================
âœ… Completed: ChTax.py
Execution time: 2.23 seconds


ğŸ”„ Starting: CitationsRD.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/CitationsRD.py:134: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  df = df.groupby("gvkey").apply(lambda x: x.iloc[2:]).reset_index(drop=True)
Loading SignalMasterTable...
After early date filter: (3481556, 6)
Loading and merging Compustat...
After Compustat merge: (3481556, 11)
After dropping missing gvkey: (2875811, 11)
Loading and merging patent data...
After patent merge: (2875811, 12)
Creating calendar-based lags...
After creating lags: (2936352, 13)
Filtering to June observations...
After June filter: (238001, 13)
Creating calendar-based rolling sums...
  Computing 48-month calendar rolling XRD sums...
  Computing 48-month calendar rolling citation sums...
Creating size categories...
Creating CitationsRD tercile categories...
Expanding to monthly observations...
saving CitationsRD
Saved 660600 rows to ../pyData/Predictors/CitationsRD.csv
============================================================
âœ… Completed: CitationsRD.py
Execution time: 5.72 seconds


ğŸ”„ Starting: CompEquIss.py
============================================================
Starting CompEquIss predictor...
Loading SignalMasterTable...
Loaded 4,047,630 SignalMasterTable observations
Constructing CompEquIss signal...
Creating 60-month lags with calendar validation...
Generated CompEquIss values for 2,560,488 observations
Saving predictor...
saving CompEquIss
Saved 2560488 rows to ../pyData/Predictors/CompEquIss.csv
CompEquIss predictor completed successfully!
============================================================
âœ… Completed: CompEquIss.py
Execution time: 2.98 seconds


ğŸ”„ Starting: CompositeDebtIssuance.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: invalid value encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
Starting CompositeDebtIssuance predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
Constructing CompositeDebtIssuance signal...
After deduplication: 3,626,811 observations
Calculating 60-month calendar-based lag...
Generated CompositeDebtIssuance values for 2,158,449 observations
Saving predictor...
saving CompositeDebtIssuance
Saved 2158449 rows to ../pyData/Predictors/CompositeDebtIssuance.csv
CompositeDebtIssuance predictor completed successfully!
============================================================
âœ… Completed: CompositeDebtIssuance.py
Execution time: 1.34 seconds


ğŸ”„ Starting: ConsRecomm.py
============================================================
Starting ConsRecomm predictor...
Loading IBES Recommendations data...
Loaded 869,760 IBES recommendations observations
After first collapse: 843,690 observations
After second collapse: 554,642 observations
Generated ConsRecomm values for 161,455 observations
Loading SignalMasterTable...
Loaded 4,047,630 SignalMasterTable observations
Merging data...
After merging: 461,823 observations
Saving predictor...
saving ConsRecomm
Saved 133046 rows to ../pyData/Predictors/ConsRecomm.csv
ConsRecomm predictor completed successfully!
============================================================
âœ… Completed: ConsRecomm.py
Execution time: 0.87 seconds


ğŸ”„ Starting: ConvDebt.py
============================================================
Starting ConvDebt predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
Constructing ConvDebt signal...
After deduplication: 3,626,811 observations
Generated ConvDebt values for 3,626,811 observations
ConvDebt = 1 for 481,714 observations
Saving predictor...
saving ConvDebt
Saved 3626811 rows to ../pyData/Predictors/ConvDebt.csv
ConvDebt predictor completed successfully!
============================================================
âœ… Completed: ConvDebt.py
Execution time: 0.72 seconds


ğŸ”„ Starting: CoskewACX.py
============================================================
Loading daily CRSP data...
Loaded dailyCRSP: (107662961, 7) rows
After 1962-07-02 filter: (98768585, 7) rows
Loading daily Fama-French data...
Loaded dailyFF: (26066, 6) rows
Merging CRSP and FF data...
After merging with FF: (98768585, 9) rows
Converting to continuous-time compounded returns...
Data ready for processing: (98768585, 9) rows
Starting 12-month batch processing loop...
Processing batch 1/12...
  Batch 1: 93486210 observations after time assignment
  Batch 1: 344824 final observations
Processing batch 2/12...
  Batch 2: 93663925 observations after time assignment
  Batch 2: 344947 final observations
Processing batch 3/12...
  Batch 3: 93934869 observations after time assignment
  Batch 3: 345413 final observations
Processing batch 4/12...
  Batch 4: 94115199 observations after time assignment
  Batch 4: 345627 final observations
Processing batch 5/12...
  Batch 5: 94361510 observations after time assignment
  Batch 5: 346194 final observations
Processing batch 6/12...
  Batch 6: 94571108 observations after time assignment
  Batch 6: 347141 final observations
Processing batch 7/12...
  Batch 7: 94742725 observations after time assignment
  Batch 7: 349622 final observations
Processing batch 8/12...
  Batch 8: 94992396 observations after time assignment
  Batch 8: 349461 final observations
Processing batch 9/12...
  Batch 9: 95149874 observations after time assignment
  Batch 9: 350302 final observations
Processing batch 10/12...
  Batch 10: 95407990 observations after time assignment
  Batch 10: 350850 final observations
Processing batch 11/12...
  Batch 11: 95566186 observations after time assignment
  Batch 11: 351241 final observations
Processing batch 12/12...
  Batch 12: 95769074 observations after time assignment
  Batch 12: 353523 final observations
Combining all batches...
Final combined dataset: (4179145, 3) rows
Final summary statistics:
shape: (9, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ statistic  â”† permno       â”† yyyymm        â”† CoskewACX  â”‚
â”‚ ---        â”† ---          â”† ---           â”† ---        â”‚
â”‚ str        â”† f64          â”† f64           â”† f64        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ count      â”† 4.179145e6   â”† 4.179145e6    â”† 4.179145e6 â”‚
â”‚ null_count â”† 0.0          â”† 0.0           â”† 0.0        â”‚
â”‚ mean       â”† 55200.306551 â”† 199858.951931 â”† -0.139924  â”‚
â”‚ std        â”† 28840.682547 â”† 1620.653336   â”† 0.336055   â”‚
â”‚ min        â”† 10000.0      â”† 196207.0      â”† -6.27726   â”‚
â”‚ 25%        â”† 24803.0      â”† 198611.0      â”† -0.220951  â”‚
â”‚ 50%        â”† 60186.0      â”† 199907.0      â”† -0.085962  â”‚
â”‚ 75%        â”† 81674.0      â”† 201211.0      â”† 0.020672   â”‚
â”‚ max        â”† 93436.0      â”† 202412.0      â”† 3.566625   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Saving to CSV...
âœ… CoskewACX.csv saved with 4179145 observations
CoskewACX translation complete!
============================================================
âœ… Completed: CoskewACX.py
Execution time: 85.25 seconds


ğŸ”„ Starting: Coskewness.py
============================================================
Loading monthly CRSP data...
Loaded monthlyCRSP: (5153763, 18) rows
Loading monthly Fama-French data...
Loaded monthlyFF: (1190, 6) rows
Merging CRSP and FF data...
After merging with FF: (5150010, 20) rows
Data ready for processing: (5150010, 19) rows
Generated m60 variable with values 0-59
Starting 60-batch processing loop...
Processing batch 1/60...
  Batch 1: 3914622 observations after time assignment
  Batch 1: 73434 final observations
Processing batch 2/60...
  Batch 2: 3920954 observations after time assignment
  Batch 2: 73418 final observations
Processing batch 3/60...
  Batch 3: 3930228 observations after time assignment
  Batch 3: 73485 final observations
Processing batch 4/60...
  Batch 4: 3936849 observations after time assignment
  Batch 4: 73487 final observations
Processing batch 5/60...
  Batch 5: 3947083 observations after time assignment
  Batch 5: 73610 final observations
Processing batch 6/60...
  Batch 6: 3953857 observations after time assignment
  Batch 6: 73690 final observations
Processing batch 7/60...
  Batch 7: 3958786 observations after time assignment
  Batch 7: 73718 final observations
Processing batch 8/60...
  Batch 8: 3966657 observations after time assignment
  Batch 8: 73707 final observations
Processing batch 9/60...
  Batch 9: 3972098 observations after time assignment
  Batch 9: 73651 final observations
Processing batch 10/60...
  Batch 10: 3979291 observations after time assignment
  Batch 10: 73741 final observations
Processing batch 11/60...
  Batch 11: 3986631 observations after time assignment
  Batch 11: 73818 final observations
Processing batch 12/60...
  Batch 12: 3993311 observations after time assignment
  Batch 12: 73854 final observations
Processing batch 13/60...
  Batch 13: 3994640 observations after time assignment
  Batch 13: 73700 final observations
Processing batch 14/60...
  Batch 14: 4001278 observations after time assignment
  Batch 14: 73703 final observations
Processing batch 15/60...
  Batch 15: 4012120 observations after time assignment
  Batch 15: 73778 final observations
Processing batch 16/60...
  Batch 16: 4019683 observations after time assignment
  Batch 16: 73800 final observations
Processing batch 17/60...
  Batch 17: 4026528 observations after time assignment
  Batch 17: 73807 final observations
Processing batch 18/60...
  Batch 18: 4035080 observations after time assignment
  Batch 18: 74041 final observations
Processing batch 19/60...
  Batch 19: 4043026 observations after time assignment
  Batch 19: 74204 final observations
Processing batch 20/60...
  Batch 20: 4053320 observations after time assignment
  Batch 20: 74345 final observations
Processing batch 21/60...
  Batch 21: 4061445 observations after time assignment
  Batch 21: 74407 final observations
Processing batch 22/60...
  Batch 22: 4073119 observations after time assignment
  Batch 22: 74587 final observations
Processing batch 23/60...
  Batch 23: 4082686 observations after time assignment
  Batch 23: 74726 final observations
Processing batch 24/60...
  Batch 24: 4091912 observations after time assignment
  Batch 24: 74890 final observations
Processing batch 25/60...
  Batch 25: 4093565 observations after time assignment
  Batch 25: 74761 final observations
Processing batch 26/60...
  Batch 26: 4105875 observations after time assignment
  Batch 26: 74850 final observations
Processing batch 27/60...
  Batch 27: 4119577 observations after time assignment
  Batch 27: 75168 final observations
Processing batch 28/60...
  Batch 28: 4128351 observations after time assignment
  Batch 28: 75400 final observations
Processing batch 29/60...
  Batch 29: 4138703 observations after time assignment
  Batch 29: 75730 final observations
Processing batch 30/60...
  Batch 30: 4148217 observations after time assignment
  Batch 30: 76575 final observations
Processing batch 31/60...
  Batch 31: 4153874 observations after time assignment
  Batch 31: 76825 final observations
Processing batch 32/60...
  Batch 32: 4158241 observations after time assignment
  Batch 32: 76821 final observations
Processing batch 33/60...
  Batch 33: 4163439 observations after time assignment
  Batch 33: 76900 final observations
Processing batch 34/60...
  Batch 34: 4170894 observations after time assignment
  Batch 34: 77130 final observations
Processing batch 35/60...
  Batch 35: 4176977 observations after time assignment
  Batch 35: 77278 final observations
Processing batch 36/60...
  Batch 36: 4189057 observations after time assignment
  Batch 36: 77513 final observations
Processing batch 37/60...
  Batch 37: 4192051 observations after time assignment
  Batch 37: 77414 final observations
Processing batch 38/60...
  Batch 38: 4202245 observations after time assignment
  Batch 38: 77551 final observations
Processing batch 39/60...
  Batch 39: 4212354 observations after time assignment
  Batch 39: 77674 final observations
Processing batch 40/60...
  Batch 40: 4218136 observations after time assignment
  Batch 40: 77645 final observations
Processing batch 41/60...
  Batch 41: 4225288 observations after time assignment
  Batch 41: 77697 final observations
Processing batch 42/60...
  Batch 42: 4233999 observations after time assignment
  Batch 42: 77817 final observations
Processing batch 43/60...
  Batch 43: 4238948 observations after time assignment
  Batch 43: 78637 final observations
Processing batch 44/60...
  Batch 44: 4246853 observations after time assignment
  Batch 44: 78681 final observations
Processing batch 45/60...
  Batch 45: 4255845 observations after time assignment
  Batch 45: 78695 final observations
Processing batch 46/60...
  Batch 46: 4265646 observations after time assignment
  Batch 46: 78824 final observations
Processing batch 47/60...
  Batch 47: 4271719 observations after time assignment
  Batch 47: 79008 final observations
Processing batch 48/60...
  Batch 48: 4280329 observations after time assignment
  Batch 48: 81419 final observations
Processing batch 49/60...
  Batch 49: 4279390 observations after time assignment
  Batch 49: 81194 final observations
Processing batch 50/60...
  Batch 50: 4288923 observations after time assignment
  Batch 50: 81202 final observations
Processing batch 51/60...
  Batch 51: 4297370 observations after time assignment
  Batch 51: 81239 final observations
Processing batch 52/60...
  Batch 52: 4305370 observations after time assignment
  Batch 52: 81291 final observations
Processing batch 53/60...
  Batch 53: 4315479 observations after time assignment
  Batch 53: 81408 final observations
Processing batch 54/60...
  Batch 54: 4325582 observations after time assignment
  Batch 54: 81590 final observations
Processing batch 55/60...
  Batch 55: 4332723 observations after time assignment
  Batch 55: 81668 final observations
Processing batch 56/60...
  Batch 56: 4341627 observations after time assignment
  Batch 56: 81759 final observations
Processing batch 57/60...
  Batch 57: 4351337 observations after time assignment
  Batch 57: 81872 final observations
Processing batch 58/60...
  Batch 58: 4358505 observations after time assignment
  Batch 58: 81987 final observations
Processing batch 59/60...
  Batch 59: 4366507 observations after time assignment
  Batch 59: 82106 final observations
Processing batch 60/60...
  Batch 60: 4373841 observations after time assignment
  Batch 60: 82228 final observations
Combining all batches...
Final combined dataset: (4609158, 3) rows
Final summary statistics:
shape: (9, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ statistic  â”† permno       â”† yyyymm        â”† Coskewness â”‚
â”‚ ---        â”† ---          â”† ---           â”† ---        â”‚
â”‚ str        â”† f64          â”† f64           â”† f64        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ count      â”† 4.609158e6   â”† 4.609158e6    â”† 4.609158e6 â”‚
â”‚ null_count â”† 0.0          â”† 0.0           â”† 0.0        â”‚
â”‚ mean       â”† 52288.249363 â”† 199446.017069 â”† -0.200024  â”‚
â”‚ std        â”† 29515.076279 â”† 2104.481887   â”† 0.382642   â”‚
â”‚ min        â”† 10000.0      â”† 192706.0      â”† -4.491474  â”‚
â”‚ 25%        â”† 20802.0      â”† 198208.0      â”† -0.384794  â”‚
â”‚ 50%        â”† 54148.0      â”† 199708.0      â”† -0.179384  â”‚
â”‚ 75%        â”† 80581.0      â”† 201107.0      â”† 0.01241    â”‚
â”‚ max        â”† 93436.0      â”† 202412.0      â”† 2.53694    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Saving to CSV...
âœ… Coskewness.csv saved with 4609158 observations
Coskewness translation complete!
============================================================
âœ… Completed: Coskewness.py
Execution time: 15.83 seconds


ğŸ”„ Starting: CPVolSpread.py
============================================================
Starting CPVolSpread.py...
Loading and cleaning OptionMetrics data...
Cleaned OptionMetrics data: 1867260 rows, 8 columns
Computed CPVolSpread for 881808 observations
Loading SignalMasterTable...
After merging with options data: 1802872 rows
After filtering closed-end funds and REITs: 1798132 rows
Final CPVolSpread for 691983 observations
saving CPVolSpread
Saved 691983 rows to ../pyData/Predictors/CPVolSpread.csv
CPVolSpread.py completed successfully
============================================================
âœ… Completed: CPVolSpread.py
Execution time: 2.14 seconds


ğŸ”„ Starting: CredRatDG.py
============================================================
Starting CredRatDG predictor...
Loading m_SP_creditratings data...
Generated dataset of 12,902 SP downgrades
Loading m_CIQ_creditratings data...
Loading SignalMasterTable...
Loaded 3,041,691 SignalMasterTable observations
Merging data...
After merging: 3,041,691 observations
Constructing CredRatDG signal...
Saving predictor...
saving CredRatDG
Saved 3041691 rows to ../pyData/Predictors/CredRatDG.csv
CredRatDG predictor completed successfully!
============================================================
âœ… Completed: CredRatDG.py
Execution time: 1.78 seconds


ğŸ”„ Starting: CustomerMomentum.py
============================================================
2025-10-14 12:27:41,838 - INFO - Starting customer momentum processing...
2025-10-14 12:27:41,838 - INFO - Loading input data...
2025-10-14 12:27:42,213 - INFO - Loaded customer segments: 704,826 rows
2025-10-14 12:27:42,257 - INFO - Loaded CCM linking: 31,917 rows
2025-10-14 12:27:42,386 - INFO - Loaded CRSP monthly: 5,153,763 rows
2025-10-14 12:27:42,386 - INFO - Cleaning customer data...
2025-10-14 12:27:43,240 - INFO - After cleaning customer data: 224,325 rows
2025-10-14 12:27:43,240 - INFO - Cleaning CCM data...
2025-10-14 12:27:43,342 - INFO - Cleaned CCM data: 31,917 rows
2025-10-14 12:27:43,342 - INFO - Adding permno data...
2025-10-14 12:27:43,399 - INFO - After inner join with CCM: 253,132 rows
2025-10-14 12:27:43,439 - INFO - After date filtering: 181,366 rows
2025-10-14 12:27:43,474 - INFO - After customer name matching: 210,384 rows
2025-10-14 12:27:43,480 - INFO - After customer filtering: 45,638 rows
2025-10-14 12:27:43,486 - INFO - Final customer-firm relationships: 45,638 rows
2025-10-14 12:27:43,486 - INFO - Creating monthly frame...
2025-10-14 12:27:43,639 - INFO - Monthly frame: 1,037,364 rows
2025-10-14 12:27:43,639 - INFO - Creating wide customer data...
2025-10-14 12:27:43,665 - INFO - Wide format data: 26,883 rows, 26 customer columns
2025-10-14 12:27:43,675 - INFO - Wide customer data with stop rows: 31,810 rows
2025-10-14 12:27:43,675 - INFO - Merging and filling customer data...
2025-10-14 12:27:44,528 - INFO - Long customer data after fill: 600,564 rows
2025-10-14 12:27:44,528 - INFO - Calculating customer momentum...
2025-10-14 12:27:44,606 - INFO - Customer returns: 696,734 rows
2025-10-14 12:27:44,654 - INFO - After merging customer returns: 560,270 rows
2025-10-14 12:27:44,704 - INFO - Final customer momentum: 356,136 rows
2025-10-14 12:27:44,705 - INFO - Saving predictor...
2025-10-14 12:27:44,726 - INFO - CustomerMomentum predictor completed successfully!
saving CustomerMomentum
Saved 356136 rows to ../pyData/Predictors/CustomerMomentum.csv
============================================================
âœ… Completed: CustomerMomentum.py
Execution time: 3.30 seconds


ğŸ”„ Starting: dCPVolSpread.py
============================================================
Starting dCPVolSpread.py...
Loading OptionMetrics volatility surface data...
Loaded options data: 4617772 rows
After screening: 2308886 rows
Calculating volatility changes...
Merging with SignalMasterTable...
After merge: 4047630 rows
Calculated dCPVolSpread for 862966 observations
saving dCPVolSpread
Saved 862966 rows to ../pyData/Predictors/dCPVolSpread.csv
dCPVolSpread.py completed successfully
============================================================
âœ… Completed: dCPVolSpread.py
Execution time: 2.50 seconds


ğŸ”„ Starting: DebtIssuance.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: invalid value encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
Starting DebtIssuance predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
Loading SignalMasterTable...
Loaded 4,047,630 SignalMasterTable observations
Merging data...
After merging: 3,041,691 observations
Constructing DebtIssuance signal...
Generated DebtIssuance values for 2,726,040 observations
Saving predictor...
saving DebtIssuance
Saved 2726040 rows to ../pyData/Predictors/DebtIssuance.csv
DebtIssuance predictor completed successfully!
============================================================
âœ… Completed: DebtIssuance.py
Execution time: 2.19 seconds


ğŸ”„ Starting: DelBreadth.py
============================================================
DelBreadth predictor saved successfully
============================================================
âœ… Completed: DelBreadth.py
Execution time: 1.83 seconds


ğŸ”„ Starting: DelCOA.py
============================================================
Starting DelCOA.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 6 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Setting up panel data structure...
Creating lag variables...
Creating tempAvAT...
Calculating DelCOA...
Calculated DelCOA for 3312759 observations
saving DelCOA
Saved 3312759 rows to ../pyData/Predictors/DelCOA.csv
DelCOA.py completed successfully
============================================================
âœ… Completed: DelCOA.py
Execution time: 0.86 seconds


ğŸ”„ Starting: DelCOL.py
============================================================
Starting DelCOL.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 6 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Setting up panel data structure...
Creating lag variables...
Creating tempAvAT...
Calculating DelCOL...
Calculated DelCOL for 3277150 observations
saving DelCOL
Saved 3277150 rows to ../pyData/Predictors/DelCOL.csv
DelCOL.py completed successfully
============================================================
âœ… Completed: DelCOL.py
Execution time: 1.57 seconds


ğŸ”„ Starting: DelDRC.py
============================================================
Starting DelDRC.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 8 columns
Deduplicating by permno time_avail_m...
After deduplication: 3626811 rows
Setting up panel data structure...
Ensuring sic is numeric...
Creating lag variables...
Calculating DelDRC...
Applying filters...
Calculated DelDRC for 463078 observations
saving DelDRC
Saved 463078 rows to ../pyData/Predictors/DelDRC.csv
DelDRC.py completed successfully
============================================================
âœ… Completed: DelDRC.py
Execution time: 2.13 seconds


ğŸ”„ Starting: DelEqu.py
============================================================
DelEqu: Saved 3,196,452 observations
============================================================
âœ… Completed: DelEqu.py
Execution time: 3.75 seconds


ğŸ”„ Starting: DelFINL.py
============================================================
DelFINL: Saved 3,252,877 observations
============================================================
âœ… Completed: DelFINL.py
Execution time: 3.84 seconds


ğŸ”„ Starting: DelLTI.py
============================================================
DelLTI: Saved 3,297,084 observations
============================================================
âœ… Completed: DelLTI.py
Execution time: 3.32 seconds


ğŸ”„ Starting: DelNetFin.py
============================================================
DelNetFin: Saved 3,252,877 observations
============================================================
âœ… Completed: DelNetFin.py
Execution time: 3.90 seconds


ğŸ”„ Starting: DivInit.py
============================================================
================================================================================
ğŸ—ï¸  DivInit.py
Creating dividend initiation predictor
================================================================================
ğŸ“Š Loading distributions data...
Loaded distributions: 1,064,085 observations
ğŸ§® Computing dividend initiation signal...
ğŸ’¾ Saving DivInit predictor...
saving DivInit
Saved 4112633 rows to ../pyData/Predictors/DivInit.csv
âœ… DivInit.csv saved successfully
============================================================
âœ… Completed: DivInit.py
Execution time: 2.20 seconds


ğŸ”„ Starting: DivOmit.py
============================================================
DivOmit predictor saved successfully
============================================================
âœ… Completed: DivOmit.py
Execution time: 6.21 seconds


ğŸ”„ Starting: DivSeason.py
============================================================
Starting DivSeason.py...
Loading CRSP distributions data...
Loaded distributions data: 1064085 rows
After filtering for regular cash dividends: 974654 rows
Loading SignalMasterTable...
Loaded SignalMasterTable: 4047630 rows
Merging with dividend amounts...
After merge: 4047630 rows
Calculating DivSeason signal...
Creating 12-month rolling dividend payments...
Creating lag variables for dividend prediction...
Calculated DivSeason for 1785982 observations
saving DivSeason
Saved 1785982 rows to ../pyData/Predictors/DivSeason.csv
DivSeason.py completed successfully
============================================================
âœ… Completed: DivSeason.py
Execution time: 1.90 seconds


ğŸ”„ Starting: DivYieldST.py
============================================================
DivYieldST predictor saved successfully
============================================================
âœ… Completed: DivYieldST.py
Execution time: 4.10 seconds


ğŸ”„ Starting: dNoa.py
============================================================
Starting dNoa predictor...
Loading m_aCompustat data...
Loaded 3,626,811 m_aCompustat observations
Deduplicating by permno time_avail_m...
After deduplication: 3,626,811 observations
Constructing dNoa signal...
Generated dNoa values for 3,196,374 observations
Saving predictor...
saving dNoa
Saved 3196374 rows to ../pyData/Predictors/dNoa.csv
dNoa predictor completed successfully!
============================================================
âœ… Completed: dNoa.py
Execution time: 1.62 seconds


ğŸ”„ Starting: DolVol.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
DolVol predictor saved successfully
============================================================
âœ… Completed: DolVol.py
Execution time: 5.02 seconds


ğŸ”„ Starting: DownRecomm.py
============================================================
DownRecomm predictor created with 461823 observations
============================================================
âœ… Completed: DownRecomm.py
Execution time: 1.01 seconds


ğŸ”„ Starting: dVolCall.py
============================================================
Starting dVolCall.py...
Loading data...
Calculated dVolCall for 862966 observations
saving dVolCall
Saved 862966 rows to ../pyData/Predictors/dVolCall.csv
dVolCall.py completed successfully
============================================================
âœ… Completed: dVolCall.py
Execution time: 2.01 seconds


ğŸ”„ Starting: dVolPut.py
============================================================
Starting dVolPut.py...
Loading data...
Calculated dVolPut for 862966 observations
saving dVolPut
Saved 862966 rows to ../pyData/Predictors/dVolPut.csv
dVolPut.py completed successfully
============================================================
âœ… Completed: dVolPut.py
Execution time: 2.02 seconds


ğŸ”„ Starting: EarningsConsistency.py
============================================================
Starting EarningsConsistency.py...
Loading m_aCompustat data...
Loaded data: 3626811 rows
Setting up panel data structure...
Creating lag variables for earnings...
Creating additional lag variables for earnings growth...
Calculating earnings consistency...
Calculated EarningsConsistency for 1387650 observations
saving EarningsConsistency
Saved 1387650 rows to ../pyData/Predictors/EarningsConsistency.csv
EarningsConsistency.py completed successfully
============================================================
âœ… Completed: EarningsConsistency.py
Execution time: 1.93 seconds


ğŸ”„ Starting: EarningsForecastDisparity.py
============================================================
Starting EarningsForecastDisparity.py...
============================================================
âœ… Completed: EarningsForecastDisparity.py
Execution time: 4.06 seconds


ğŸ”„ Starting: EarningsStreak.py
============================================================
EarningsStreak predictor created with 1228843 observations
============================================================
âœ… Completed: EarningsStreak.py
Execution time: 4.72 seconds


ğŸ”„ Starting: EarningsSurprise.py
============================================================
EarningsSurprise predictor created with 2324059 observations
============================================================
âœ… Completed: EarningsSurprise.py
Execution time: 11.09 seconds


ğŸ”„ Starting: EarnSupBig.py
============================================================
Creating EarnSupBig predictor...
Final dataset has 3775465 observations with 2336094 non-missing EarnSupBig values
saving EarnSupBig
Saved 2336094 rows to ../pyData/Predictors/EarnSupBig.csv
EarnSupBig predictor saved successfully
============================================================
âœ… Completed: EarnSupBig.py
Execution time: 42.26 seconds


ğŸ”„ Starting: EntMult.py
============================================================
EntMult predictor saved successfully
============================================================
âœ… Completed: EntMult.py
Execution time: 3.82 seconds


ğŸ”„ Starting: EP.py
============================================================
EP: Saved 2,203,180 observations
============================================================
âœ… Completed: EP.py
Execution time: 3.39 seconds


ğŸ”„ Starting: EquityDuration.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/EquityDuration.py:128: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_monthly["temp_na_sort"] = df_monthly["EquityDuration"].isna()
Loading and processing EquityDuration...
Expanding to monthly observations...
EquityDuration predictor saved successfully
============================================================
âœ… Completed: EquityDuration.py
Execution time: 6.99 seconds


ğŸ”„ Starting: ExchSwitch.py
============================================================
ExchSwitch predictor saved successfully
============================================================
âœ… Completed: ExchSwitch.py
Execution time: 4.18 seconds


ğŸ”„ Starting: ExclExp.py
============================================================
ExclExp predictor saved successfully
============================================================
âœ… Completed: ExclExp.py
Execution time: 3.74 seconds


ğŸ”„ Starting: FEPS.py
============================================================
Starting FEPS.py...
Loading and preparing IBES data...
Prepared IBES data: 2401222 rows, 3 columns
Loading SignalMasterTable...
Loaded SignalMasterTable: 4047630 rows, 3 columns
Merging with IBES data...
After merging with IBES data: 4047630 rows
Setting up panel data (sorting by permno, time_avail_m)...
Calculating FEPS...
Calculated FEPS for 1951341 observations
saving FEPS
Saved 1951341 rows to ../pyData/Predictors/FEPS.csv
FEPS.py completed successfully
============================================================
âœ… Completed: FEPS.py
Execution time: 1.65 seconds


ğŸ”„ Starting: fgr5yrLag.py
============================================================
Loading IBES data...
IBES loaded: 7,902,568 rows
Filtering IBES...
Renaming IBES columns...
IBES ready: 1,428,363 rows
Loading Compustat data...
Compustat loaded: 3,626,811 rows
After dedup: 3,626,811 rows
Merging with SignalMasterTable...
After SMT merge: 3,041,691 rows
Optimizing IBES merge...
IBES filtered from 1,428,363 to 1,231,716 rows
After IBES merge: 1,141,754 rows
Filtering required variables...
After dropna: 998,737 rows
Calculating 6-month calendar lags...
fgr5yrLag predictor saved successfully
============================================================
âœ… Completed: fgr5yrLag.py
Execution time: 35.50 seconds


ğŸ”„ Starting: FirmAge.py
============================================================
FirmAge predictor saved successfully
============================================================
âœ… Completed: FirmAge.py
Execution time: 3.09 seconds


ğŸ”„ Starting: FirmAgeMom.py
============================================================
saving FirmAgeMom
Saved 550955 rows to ../pyData/Predictors/FirmAgeMom.csv
FirmAgeMom predictor completed
============================================================
âœ… Completed: FirmAgeMom.py
Execution time: 1.87 seconds


ğŸ”„ Starting: ForecastDispersion.py
============================================================
Starting ForecastDispersion.py...
Loading and preparing IBES data...
Prepared IBES data: 2401222 rows, 9 columns
Loading SignalMasterTable...
Loaded SignalMasterTable: 4047630 rows, 3 columns
Merging with IBES data...
After merging with IBES data: 4047630 rows
Calculating ForecastDispersion...
Calculated ForecastDispersion for 1616077 observations
saving ForecastDispersion
Saved 1616077 rows to ../pyData/Predictors/ForecastDispersion.csv
ForecastDispersion.py completed successfully
============================================================
âœ… Completed: ForecastDispersion.py
Execution time: 1.64 seconds


ğŸ”„ Starting: Frontier.py
============================================================
Frontier.py starting with max_year=None
Loading data...
Computing FF48 industry codes...
Processing 889 time periods (starting from 1950-12)...
Processed 151/889 periods (17.0%), stored 66 predictions for 1963-06
  Elapsed: 0.6s, Est. remaining: 66.1s, Avg: 0.090s/period (last 7 periods)
Processed 181/889 periods (20.4%), stored 55 predictions for 1965-12
  Elapsed: 1.1s, Est. remaining: 10.3s, Avg: 0.015s/period (last 30 periods)
Processed 211/889 periods (23.7%), stored 152 predictions for 1968-06
  Elapsed: 1.7s, Est. remaining: 13.8s, Avg: 0.020s/period (last 30 periods)
Processed 241/889 periods (27.1%), stored 191 predictions for 1970-12
  Elapsed: 2.6s, Est. remaining: 19.1s, Avg: 0.029s/period (last 30 periods)
Processed 271/889 periods (30.5%), stored 1230 predictions for 1973-06
  Elapsed: 4.5s, Est. remaining: 40.2s, Avg: 0.065s/period (last 30 periods)
Processed 301/889 periods (33.9%), stored 1600 predictions for 1975-12
  Elapsed: 8.7s, Est. remaining: 82.4s, Avg: 0.140s/period (last 30 periods)
Processed 331/889 periods (37.2%), stored 1487 predictions for 1978-06
  Elapsed: 13.8s, Est. remaining: 95.5s, Avg: 0.171s/period (last 30 periods)
Processed 361/889 periods (40.6%), stored 1527 predictions for 1980-12
  Elapsed: 19.1s, Est. remaining: 92.2s, Avg: 0.175s/period (last 30 periods)
Processed 391/889 periods (44.0%), stored 1714 predictions for 1983-06
  Elapsed: 24.6s, Est. remaining: 91.3s, Avg: 0.183s/period (last 30 periods)
Processed 421/889 periods (47.4%), stored 2048 predictions for 1985-12
  Elapsed: 30.7s, Est. remaining: 95.4s, Avg: 0.204s/period (last 30 periods)
Processed 451/889 periods (50.7%), stored 2144 predictions for 1988-06
  Elapsed: 37.4s, Est. remaining: 97.5s, Avg: 0.223s/period (last 30 periods)
Processed 481/889 periods (54.1%), stored 2013 predictions for 1990-12
  Elapsed: 44.3s, Est. remaining: 94.3s, Avg: 0.231s/period (last 30 periods)
Processed 511/889 periods (57.5%), stored 2244 predictions for 1993-06
  Elapsed: 51.5s, Est. remaining: 90.7s, Avg: 0.240s/period (last 30 periods)
Processed 541/889 periods (60.9%), stored 2616 predictions for 1995-12
  Elapsed: 59.4s, Est. remaining: 91.9s, Avg: 0.264s/period (last 30 periods)
Processed 571/889 periods (64.2%), stored 3163 predictions for 1998-06
  Elapsed: 68.9s, Est. remaining: 100.2s, Avg: 0.315s/period (last 30 periods)
Processed 601/889 periods (67.6%), stored 2723 predictions for 2000-12
  Elapsed: 78.4s, Est. remaining: 91.2s, Avg: 0.317s/period (last 30 periods)
Processed 631/889 periods (71.0%), stored 2437 predictions for 2003-06
  Elapsed: 87.4s, Est. remaining: 77.3s, Avg: 0.300s/period (last 30 periods)
Processed 661/889 periods (74.4%), stored 2283 predictions for 2005-12
  Elapsed: 95.9s, Est. remaining: 64.4s, Avg: 0.283s/period (last 30 periods)
Processed 691/889 periods (77.7%), stored 2180 predictions for 2008-06
  Elapsed: 103.9s, Est. remaining: 53.0s, Avg: 0.268s/period (last 30 periods)
Processed 721/889 periods (81.1%), stored 1838 predictions for 2010-12
  Elapsed: 111.0s, Est. remaining: 39.6s, Avg: 0.236s/period (last 30 periods)
Processed 751/889 periods (84.5%), stored 1667 predictions for 2013-06
  Elapsed: 117.2s, Est. remaining: 28.6s, Avg: 0.207s/period (last 30 periods)
Processed 781/889 periods (87.9%), stored 1578 predictions for 2015-12
  Elapsed: 122.8s, Est. remaining: 20.4s, Avg: 0.189s/period (last 30 periods)
Processed 811/889 periods (91.2%), stored 1409 predictions for 2018-06
  Elapsed: 128.1s, Est. remaining: 13.7s, Avg: 0.176s/period (last 30 periods)
Processed 841/889 periods (94.6%), stored 1259 predictions for 2020-12
  Elapsed: 133.1s, Est. remaining: 7.9s, Avg: 0.165s/period (last 30 periods)
Processed 871/889 periods (98.0%), stored 1296 predictions for 2023-06
  Elapsed: 137.7s, Est. remaining: 2.8s, Avg: 0.154s/period (last 30 periods)
Total predictions generated: 1222287
Before ceq filter: 2860911
After ceq filter: 2695300
Before dropping NaN Frontier: 2695300
Final output: 1221161 observations

Timing Summary:
Total execution time: 163.27 seconds (2.72 minutes)
Processed 889 periods at 6.27 periods/second
Frontier predictor saved successfully
============================================================
âœ… Completed: Frontier.py
Execution time: 165.02 seconds


ğŸ”„ Starting: Governance.py
============================================================
Governance predictor saved successfully
============================================================
âœ… Completed: Governance.py
Execution time: 1.37 seconds


ğŸ”„ Starting: GP.py
============================================================
GP: Saved 2,974,039 observations
============================================================
âœ… Completed: GP.py
Execution time: 3.46 seconds


ğŸ”„ Starting: GrAdExp.py
============================================================
Starting GrAdExp.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 4 columns
Removing duplicate observations...
Merging with SignalMasterTable...
After merging with SignalMasterTable: 3626811 rows
Sorting data by permno and time_avail_m...
Calculating GrAdExp...
Calculating size deciles...
Applying filters...
Filtered out 145980 observations (xad < 0.1 or smallest size decile)
Final GrAdExp calculated for 906109 observations
saving GrAdExp
Saved 906109 rows to ../pyData/Predictors/GrAdExp.csv
GrAdExp.py completed successfully
============================================================
âœ… Completed: GrAdExp.py
Execution time: 2.72 seconds


ğŸ”„ Starting: GrLTNOA.py
============================================================
Starting GrLTNOA.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 14 columns
Removing duplicate observations...
Setting up panel data (sorting by permno, time_avail_m)...
Calculating 12-month lags...
Calculating GrLTNOA...
Calculated GrLTNOA for 3236688 observations
saving GrLTNOA
Saved 3236688 rows to ../pyData/Predictors/GrLTNOA.csv
GrLTNOA.py completed successfully
============================================================
âœ… Completed: GrLTNOA.py
Execution time: 1.99 seconds


ğŸ”„ Starting: GrSaleToGrInv.py
============================================================
Starting GrSaleToGrInv.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 5 columns
Removing duplicate permno-time_avail_m observations...
Setting up panel data (sorting by permno, time_avail_m)...
Calculating 12 and 24-month lags...
Calculating primary GrSaleToGrInv formula...
Applying fallback formula for missing values...
Calculated GrSaleToGrInv for 2546262 observations
saving GrSaleToGrInv
Saved 2546262 rows to ../pyData/Predictors/GrSaleToGrInv.csv
GrSaleToGrInv.py completed successfully
============================================================
âœ… Completed: GrSaleToGrInv.py
Execution time: 1.58 seconds


ğŸ”„ Starting: GrSaleToGrOverhead.py
============================================================
Starting GrSaleToGrOverhead.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 5 columns
Removing duplicate observations...
Setting up panel data (sorting by permno, time_avail_m)...
Calculating 12-month and 24-month lags...
Calculating GrSaleToGrOverhead using primary formula...
Applying fallback formula where primary formula is missing...
Calculated GrSaleToGrOverhead for 2682345 observations
saving GrSaleToGrOverhead
Saved 2682345 rows to ../pyData/Predictors/GrSaleToGrOverhead.csv
GrSaleToGrOverhead.py completed successfully
============================================================
âœ… Completed: GrSaleToGrOverhead.py
Execution time: 1.73 seconds


ğŸ”„ Starting: Herf.py
============================================================
Herf predictor saved successfully
============================================================
âœ… Completed: Herf.py
Execution time: 6.83 seconds


ğŸ”„ Starting: HerfAsset.py
============================================================
HerfAsset predictor saved successfully
============================================================
âœ… Completed: HerfAsset.py
Execution time: 5.65 seconds


ğŸ”„ Starting: HerfBE.py
============================================================
HerfBE predictor saved successfully
============================================================
âœ… Completed: HerfBE.py
Execution time: 6.07 seconds


ğŸ”„ Starting: High52.py
============================================================
Starting High52 calculation...
Loaded dailyCRSP data: 107662961 observations
After collapse by permno and time_avail_m: 5116571 observations
High52 calculated for 4995429 observations
saving High52
Saved 4995429 rows to ../pyData/Predictors/High52.csv
High52.csv saved successfully
============================================================
âœ… Completed: High52.py
Execution time: 12.83 seconds


ğŸ”„ Starting: hire.py
============================================================
hire: Saved 3,499,347 observations
============================================================
âœ… Completed: hire.py
Execution time: 3.76 seconds


ğŸ”„ Starting: Illiquidity.py
============================================================
Loading dailyCRSP data...
Constructing Illiquidity signal...
Final dataset shape: (4278152, 3)
Sample of final data:
    permno  yyyymm  Illiquidity
11   10000  198612     0.000004
12   10000  198701     0.000004
13   10000  198702     0.000005
14   10000  198703     0.000008
15   10000  198704     0.000008
Saved to ../pyData/Predictors/Illiquidity.csv
============================================================
âœ… Completed: Illiquidity.py
Execution time: 13.36 seconds


ğŸ”„ Starting: IndIPO.py
============================================================
IndIPO predictor saved successfully
============================================================
âœ… Completed: IndIPO.py
Execution time: 2.52 seconds


ğŸ”„ Starting: IndMom.py
============================================================
saving IndMom
Saved 4043138 rows to ../pyData/Predictors/IndMom.csv
============================================================
âœ… Completed: IndMom.py
Execution time: 25.94 seconds


ğŸ”„ Starting: IndRetBig.py
============================================================
saving IndRetBig
Saved 2616696 rows to ../pyData/Predictors/IndRetBig.csv
IndRetBig predictor saved successfully
============================================================
âœ… Completed: IndRetBig.py
Execution time: 28.08 seconds


ğŸ”„ Starting: IntMom.py
============================================================
saving IntMom
Saved 3686625 rows to ../pyData/Predictors/IntMom.csv
Saved 4047630 observations to IntMom.csv
============================================================
âœ… Completed: IntMom.py
Execution time: 4.58 seconds


ğŸ”„ Starting: Investment.py
============================================================
Investment predictor saved successfully
============================================================
âœ… Completed: Investment.py
Execution time: 3.77 seconds


ğŸ”„ Starting: InvestPPEInv.py
============================================================
Starting InvestPPEInv.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 6 columns
Removing duplicate permno-time_avail_m observations...
Removed 0 duplicate observations
Setting up panel data (sorting by permno, time_avail_m)...
Calculating 12-month lags...
Calculating tempPPE...
Calculating tempInv...
Calculating InvestPPEInv...
Calculated InvestPPEInv for 2944447 observations
saving InvestPPEInv
Saved 2944447 rows to ../pyData/Predictors/InvestPPEInv.csv
InvestPPEInv.py completed successfully
============================================================
âœ… Completed: InvestPPEInv.py
Execution time: 1.67 seconds


ğŸ”„ Starting: InvGrowth.py
============================================================
Starting InvGrowth predictor...
Loading m_aCompustat data...
Loaded 3,626,811 Compustat observations
Loading GNPdefl data...
Loaded 942 GNPdefl observations
Merging with GNPdefl...
After merging with GNPdefl: 3,586,771 observations
Adjusting invt for inflation...
Applying sample selection filters...
After SIC filter (dropped SIC 4xxx and 6xxx): 2,626,386 observations (dropped 960,385)
After AT/PPENT filter: 2,606,793 observations (dropped 19,593)
Constructing InvGrowth signal...
After deduplication: 2,606,793 observations (dropped 0 duplicates)
Calculating 12-month lag for inventory growth...
Implementing efficient calendar-based 12-month lag...
Generated InvGrowth values for 2,003,418 observations
Saving predictor...
saving InvGrowth
Saved 2003418 rows to ../pyData/Predictors/InvGrowth.csv
InvGrowth predictor completed successfully!
============================================================
âœ… Completed: InvGrowth.py
Execution time: 3.78 seconds


ğŸ”„ Starting: IO_ShortInterest.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/IO_ShortInterest.py:76: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  temps99_by_month = df.groupby("time_avail_m").apply(
Starting IO_ShortInterest.py...
Loading data...
Calculated IO_ShortInterest for 16077 observations
saving IO_ShortInterest
Saved 16077 rows to ../pyData/Predictors/IO_ShortInterest.csv
IO_ShortInterest.py completed successfully
============================================================
âœ… Completed: IO_ShortInterest.py
Execution time: 3.61 seconds


ğŸ”„ Starting: Leverage.py
============================================================
Leverage: Saved 3,014,697 observations
============================================================
âœ… Completed: Leverage.py
Execution time: 3.40 seconds


ğŸ”„ Starting: LRreversal.py
============================================================
LRreversal predictor saved successfully
============================================================
âœ… Completed: LRreversal.py
Execution time: 4.06 seconds


ğŸ”„ Starting: MaxRet.py
============================================================
MaxRet predictor saved successfully
============================================================
âœ… Completed: MaxRet.py
Execution time: 15.41 seconds


ğŸ”„ Starting: MeanRankRevGrowth.py
============================================================
MeanRankRevGrowth predictor saved successfully
============================================================
âœ… Completed: MeanRankRevGrowth.py
Execution time: 7.34 seconds


ğŸ”„ Starting: Mom12m.py
============================================================
================================================================================
ğŸ—ï¸  Mom12m.py
Creating twelve-month momentum predictor
================================================================================
ğŸ“Š Loading SignalMasterTable data...
Loaded: 4,047,630 observations
ğŸ§® Computing 12-month momentum signal...
ğŸ’¾ Saving Mom12m predictor...
saving Mom12m
Saved 3715128 rows to ../pyData/Predictors/Mom12m.csv
âœ… Mom12m.csv saved successfully
================================================================================
âœ… Mom12m.py Complete
Twelve-month momentum predictor generated successfully
================================================================================
============================================================
âœ… Completed: Mom12m.py
Execution time: 1.50 seconds


ğŸ”„ Starting: Mom12mOffSeason.py
============================================================
Starting Mom12mOffSeason.py...
Loading data...
Creating 10 off-season lag variables...
Calculated Mom12mOffSeason for 4083294 observations
saving Mom12mOffSeason
Saved 4083294 rows to ../pyData/Predictors/Mom12mOffSeason.csv
Mom12mOffSeason.py completed successfully
============================================================
âœ… Completed: Mom12mOffSeason.py
Execution time: 2.16 seconds


ğŸ”„ Starting: Mom6m.py
============================================================
================================================================================
ğŸ—ï¸  Mom6m.py
Creating six-month momentum predictor
================================================================================
ğŸ“Š Loading SignalMasterTable data...
Loaded: 4,047,630 observations
ğŸ§® Computing 6-month momentum signal...
ğŸ’¾ Saving Mom6m predictor...
saving Mom6m
Saved 3895206 rows to ../pyData/Predictors/Mom6m.csv
âœ… Mom6m.csv saved successfully
================================================================================
âœ… Mom6m.py Complete
Six-month momentum predictor generated successfully
================================================================================
============================================================
âœ… Completed: Mom6m.py
Execution time: 1.39 seconds


ğŸ”„ Starting: Mom6mJunk.py
============================================================
left join with sp ratings, nrow = 3041691
left join with ciq ratings, nrow = 3041691
saving Mom6mJunk
Saved 346639 rows to ../pyData/Predictors/Mom6mJunk.csv
Mom6mJunk saved with 3041691 observations
============================================================
âœ… Completed: Mom6mJunk.py
Execution time: 4.44 seconds


ğŸ”„ Starting: MomOffSeason.py
============================================================
Starting MomOffSeason.py...
Loading data...
Creating 44 off-season lag variables...
Calculated MomOffSeason for 3767024 observations
saving MomOffSeason
Saved 3767024 rows to ../pyData/Predictors/MomOffSeason.csv
MomOffSeason.py completed successfully
============================================================
âœ… Completed: MomOffSeason.py
Execution time: 3.75 seconds


ğŸ”„ Starting: MomOffSeason06YrPlus.py
============================================================
Starting MomOffSeason06YrPlus.py...
Loading data...
Creating 55 off-season lag variables...
Calculated MomOffSeason06YrPlus for 2682540 observations
saving MomOffSeason06YrPlus
Saved 2682540 rows to ../pyData/Predictors/MomOffSeason06YrPlus.csv
MomOffSeason06YrPlus.py completed successfully
============================================================
âœ… Completed: MomOffSeason06YrPlus.py
Execution time: 4.12 seconds


ğŸ”„ Starting: MomOffSeason11YrPlus.py
============================================================
Starting MomOffSeason11YrPlus.py...
Loading data...
Creating 55 off-season lag variables...
Calculated MomOffSeason11YrPlus for 1842138 observations
saving MomOffSeason11YrPlus
Saved 1842138 rows to ../pyData/Predictors/MomOffSeason11YrPlus.csv
MomOffSeason11YrPlus.py completed successfully
============================================================
âœ… Completed: MomOffSeason11YrPlus.py
Execution time: 4.16 seconds


ğŸ”„ Starting: MomOffSeason16YrPlus.py
============================================================
Starting MomOffSeason16YrPlus.py...
Loading data...
Creating 55 off-season lag variables...
Calculated MomOffSeason16YrPlus for 1300410 observations
saving MomOffSeason16YrPlus
Saved 1300410 rows to ../pyData/Predictors/MomOffSeason16YrPlus.csv
MomOffSeason16YrPlus.py completed successfully
============================================================
âœ… Completed: MomOffSeason16YrPlus.py
Execution time: 4.24 seconds


ğŸ”„ Starting: MomRev.py
============================================================
================================================================================
ğŸ—ï¸  MomRev.py
Creating momentum and long-term reversal signal based on 6m and 36m momentum
================================================================================
ğŸ“Š Loading SignalMasterTable data...
Loaded: 4,047,630 observations
ğŸ§® Computing 6m and 36m momentum signals...
ğŸ’¾ Saving MomRev predictor...
saving MomRev
Saved 261618 rows to ../pyData/Predictors/MomRev.csv
âœ… MomRev.csv saved successfully
================================================================================
âœ… MomRev.py Complete
Momentum and long-term reversal signal generated successfully
================================================================================
============================================================
âœ… Completed: MomRev.py
Execution time: 4.07 seconds


ğŸ”„ Starting: MomSeason.py
============================================================
Starting MomSeason.py...
Loading SignalMasterTable...
Loaded data: 4047630 rows
Filling missing returns with 0...
Creating lag variables for returns (23, 35, 47, 59 months)...
Calculating seasonal momentum signal...
Calculated MomSeason for 3437360 observations
saving MomSeason
Saved 3437360 rows to ../pyData/Predictors/MomSeason.csv
MomSeason.py completed successfully
============================================================
âœ… Completed: MomSeason.py
Execution time: 1.78 seconds


ğŸ”„ Starting: MomSeason06YrPlus.py
============================================================
Starting MomSeason06YrPlus.py...
Loading data...
Calculated MomSeason06YrPlus for 2472493 observations
saving MomSeason06YrPlus
Saved 2472493 rows to ../pyData/Predictors/MomSeason06YrPlus.csv
MomSeason06YrPlus.py completed successfully
============================================================
âœ… Completed: MomSeason06YrPlus.py
Execution time: 1.78 seconds


ğŸ”„ Starting: MomSeason11YrPlus.py
============================================================
Starting MomSeason11YrPlus.py...
Loading data...
Calculated MomSeason11YrPlus for 1707812 observations
saving MomSeason11YrPlus
Saved 1707812 rows to ../pyData/Predictors/MomSeason11YrPlus.csv
MomSeason11YrPlus.py completed successfully
============================================================
âœ… Completed: MomSeason11YrPlus.py
Execution time: 1.78 seconds


ğŸ”„ Starting: MomSeason16YrPlus.py
============================================================
Starting MomSeason16YrPlus.py...
Loading data...
Calculated MomSeason16YrPlus for 1211157 observations
saving MomSeason16YrPlus
Saved 1211157 rows to ../pyData/Predictors/MomSeason16YrPlus.csv
MomSeason16YrPlus.py completed successfully
============================================================
âœ… Completed: MomSeason16YrPlus.py
Execution time: 1.77 seconds


ğŸ”„ Starting: MomSeasonShort.py
============================================================
Starting MomSeasonShort.py...
Loading SignalMasterTable...
Loaded data: 4047630 rows
Filling missing returns with 0...
Creating 11-month lag for seasonal momentum...
Calculated MomSeasonShort for 3730640 observations
saving MomSeasonShort
Saved 3730640 rows to ../pyData/Predictors/MomSeasonShort.csv
MomSeasonShort.py completed successfully
============================================================
âœ… Completed: MomSeasonShort.py
Execution time: 1.31 seconds


ğŸ”„ Starting: MomVol.py
============================================================
Calculating 6-month calendar-based rolling mean volume...
saving MomVol
Saved 1096816 rows to ../pyData/Predictors/MomVol.csv
============================================================
âœ… Completed: MomVol.py
Execution time: 3.40 seconds


ğŸ”„ Starting: MRreversal.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/MRreversal.py:61: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"ret_lag{lag}_orig_missing"].fillna(True).infer_objects(copy=False)
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/MRreversal.py:61: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"ret_lag{lag}_orig_missing"].fillna(True).infer_objects(copy=False)
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/MRreversal.py:61: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"ret_lag{lag}_orig_missing"].fillna(True).infer_objects(copy=False)
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/MRreversal.py:61: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"ret_lag{lag}_orig_missing"].fillna(True).infer_objects(copy=False)
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/MRreversal.py:61: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"ret_lag{lag}_orig_missing"].fillna(True).infer_objects(copy=False)
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/MRreversal.py:61: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df[f"ret_lag{lag}_orig_missing"].fillna(True).infer_objects(copy=False)
MRreversal predictor saved successfully
============================================================
âœ… Completed: MRreversal.py
Execution time: 8.91 seconds


ğŸ”„ Starting: MS.py
============================================================
================================================================================
ğŸ—ï¸  MS.py
Generating Mohanram G-score predictor
================================================================================
ğŸ“Š Loading Compustat and SignalMasterTable data...
Loading m_aCompustat.parquet...
Loaded m_aCompustat: 3,626,811 observations
After deduplication: 3,626,811 observations
Loading SignalMasterTable.parquet...
Loaded SignalMasterTable: 4,047,630 observations
Loading m_QCompustat.parquet...
Loaded m_QCompustat: 5,479,107 observations
ğŸ”— Merging datasets...
After merging: 3,041,691 observations
ğŸ¯ Applying sample selection criteria...
Calculating BM quintiles with enhanced fastxtile...
After BM quintile filter: 572,875 observations
After SIC2D minimum filter: 554,116 observations
ğŸ§® Preparing financial variables...
ğŸ“ˆ Computing quarterly aggregations...
ğŸ¯ Constructing Mohanram G-score components...
  Computing profitability and cash flow signals...
  Computing naive extrapolation (volatility) measures...
  Computing conservatism (intensity) measures...
ğŸ“… Applying timing logic...
Generated MS values: 473,082 observations
MS summary stats:
  Mean: 3.8115
  Std: 1.5211
  Min: 1
  Max: 6
ğŸ’¾ Saving MS predictor...
saving MS
Saved 473082 rows to ../pyData/Predictors/MS.csv
âœ… MS.csv saved successfully
============================================================
âœ… Completed: MS.py
Execution time: 3.52 seconds


ğŸ”„ Starting: NetDebtFinance.py
============================================================
Starting NetDebtFinance calculation...
Loaded m_aCompustat data: 3626811 observations
After deduplicating by permno time_avail_m: 3626811 observations
NetDebtFinance calculated for 2798617 observations
Final output: 2798617 observations
NetDebtFinance.csv saved successfully
============================================================
âœ… Completed: NetDebtFinance.py
Execution time: 2.93 seconds


ğŸ”„ Starting: NetDebtPrice.py
============================================================
NetDebtPrice: Saved 1,425,850 observations
============================================================
âœ… Completed: NetDebtPrice.py
Execution time: 3.97 seconds


ğŸ”„ Starting: NetEquityFinance.py
============================================================
Starting NetEquityFinance calculation...
Loaded m_aCompustat data: 3626811 observations
After deduplicating by permno time_avail_m: 3626811 observations
NetEquityFinance calculated for 2889976 observations
Final output: 2889976 observations
NetEquityFinance.csv saved successfully
============================================================
âœ… Completed: NetEquityFinance.py
Execution time: 3.13 seconds


ğŸ”„ Starting: NetPayoutYield.py
============================================================
NetPayoutYield predictor created with 1819403 observations
============================================================
âœ… Completed: NetPayoutYield.py
Execution time: 3.99 seconds


ğŸ”„ Starting: NOA.py
============================================================
Starting NOA calculation...
Loaded m_aCompustat data: 3626811 observations
After deduplicating by permno time_avail_m: 3626811 observations
NOA calculated for 3214284 observations
Final output: 3214284 observations
NOA.csv saved successfully
============================================================
âœ… Completed: NOA.py
Execution time: 3.36 seconds


ğŸ”„ Starting: NumEarnIncrease.py
============================================================
NumEarnIncrease: 2823485 observations saved
============================================================
âœ… Completed: NumEarnIncrease.py
Execution time: 6.28 seconds


ğŸ”„ Starting: OperProf.py
============================================================
OperProf: Saved 1,407,812 observations
============================================================
âœ… Completed: OperProf.py
Execution time: 2.56 seconds


ğŸ”„ Starting: OperProfRD.py
============================================================
OperProfRD predictor saved successfully
============================================================
âœ… Completed: OperProfRD.py
Execution time: 4.04 seconds


ğŸ”„ Starting: OPLeverage.py
============================================================
Loading m_aCompustat data...
Loaded 3626811 observations
After removing duplicates: 3626811 observations
Calculated OPLeverage for shape: (1, 8)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ permno  â”† time_avail_m â”† gvkey   â”† xsga    â”† cogs    â”† at      â”† tempxsga â”† OPLeverage â”‚
â”‚ ---     â”† ---          â”† ---     â”† ---     â”† ---     â”† ---     â”† ---      â”† ---        â”‚
â”‚ u32     â”† u32          â”† u32     â”† u32     â”† u32     â”† u32     â”† u32      â”† u32        â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 3610330 â”† 3610330      â”† 3610330 â”† 3019436 â”† 3610330 â”† 3610330 â”† 3610330  â”† 3610330    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ observations
saving OPLeverage
Saved 3610330 rows to ../pyData/Predictors/OPLeverage.csv
OPLeverage predictor completed successfully
============================================================
âœ… Completed: OPLeverage.py
Execution time: 0.99 seconds


ğŸ”„ Starting: OrderBacklog.py
============================================================
OrderBacklog predictor saved successfully
============================================================
âœ… Completed: OrderBacklog.py
Execution time: 2.03 seconds


ğŸ”„ Starting: OrderBacklogChg.py
============================================================
OrderBacklogChg predictor saved successfully
============================================================
âœ… Completed: OrderBacklogChg.py
Execution time: 1.99 seconds


ğŸ”„ Starting: OScore.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
OScore predictor saved successfully
============================================================
âœ… Completed: OScore.py
Execution time: 5.03 seconds


ğŸ”„ Starting: PatentsRD.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/PatentsRD.py:115: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda x: x.iloc[2:] if len(x) > 2 else x.iloc[0:0])
PatentsRD predictor saved successfully
============================================================
âœ… Completed: PatentsRD.py
Execution time: 57.72 seconds


ğŸ”„ Starting: PayoutYield.py
============================================================
PayoutYield predictor created with 1419744 observations
============================================================
âœ… Completed: PayoutYield.py
Execution time: 3.91 seconds


ğŸ”„ Starting: PctAcc.py
============================================================
PctAcc predictor saved successfully
============================================================
âœ… Completed: PctAcc.py
Execution time: 4.85 seconds


ğŸ”„ Starting: PctTotAcc.py
============================================================
PctTotAcc predictor saved successfully
============================================================
âœ… Completed: PctTotAcc.py
Execution time: 3.83 seconds


ğŸ”„ Starting: Price.py
============================================================
Price: Saved 4,029,252 observations
============================================================
âœ… Completed: Price.py
Execution time: 4.21 seconds


ğŸ”„ Starting: ProbInformedTrading.py
============================================================
ProbInformedTrading predictor saved with 24028 observations
============================================================
âœ… Completed: ProbInformedTrading.py
Execution time: 1.64 seconds


ğŸ”„ Starting: PS.py
============================================================
Starting PS.py...
Loading m_aCompustat data...
Merging with SignalMasterTable...
Loaded and merged data: 3041691 rows
Setting up panel data structure and calculating Piotroski score...
Calculated PS for 464243 observations
saving PS
Saved 464243 rows to ../pyData/Predictors/PS.csv
PS.py completed successfully
============================================================
âœ… Completed: PS.py
Execution time: 6.70 seconds


ğŸ”„ Starting: RD.py
============================================================
RD: Saved 1,419,173 observations
============================================================
âœ… Completed: RD.py
Execution time: 2.11 seconds


ğŸ”„ Starting: RDAbility.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/RDAbility.py:163: DeprecationWarning: the argument `min_periods` for `Expr.rolling_mean` is deprecated. It was renamed to `min_samples` in version 1.21.0.
  "mean": lambda col: col.rolling_mean(
================================================================================
RDAbility.py
Generating R&D ability predictor using Cohen, Diether and Malloy (2013) methodology
================================================================================
Loading a_aCompustat data...
Loaded Compustat: 302,436 observations
Expanding to monthly observations...
Before expansion: 302,436 observations
After expansion: 3,629,232 observations
Applying final filters...
After gvkey-time filter: 3,626,933 observations
After permno-time filter: 3,626,811 observations
Generated RDAbility values: 3,626,811 observations
Non-null RDAbility: 181,065 observations
RDAbility summary stats:
  Mean: 0.473175
  Std: 5.421397
  Min: -170.731482
  Max: 125.476431
Saving RDAbility predictor...
saving RDAbility
Saved 181065 rows to ../pyData/Predictors/RDAbility.csv
RDAbility.csv saved successfully
============================================================
âœ… Completed: RDAbility.py
Execution time: 12.66 seconds


ğŸ”„ Starting: RDcap.py
============================================================
saving RDcap
Saved 537857 rows to ../pyData/Predictors/RDcap.csv
RDcap predictor saved successfully
============================================================
âœ… Completed: RDcap.py
Execution time: 2.72 seconds


ğŸ”„ Starting: RDIPO.py
============================================================
RDIPO predictor saved successfully
============================================================
âœ… Completed: RDIPO.py
Execution time: 3.50 seconds


ğŸ”„ Starting: RDS.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/RDS.py:118: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  & df["l12_recta_orig_missing"].fillna(True).infer_objects(copy=False)
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/RDS.py:121: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  & df["l12_msa_orig_missing"].fillna(True).infer_objects(copy=False)
RDS: Saved 2,817,703 observations
============================================================
âœ… Completed: RDS.py
Execution time: 28.57 seconds


ğŸ”„ Starting: realestate.py
============================================================
realestate predictor saved successfully
============================================================
âœ… Completed: realestate.py
Execution time: 4.40 seconds


ğŸ”„ Starting: Recomm_ShortInterest.py
============================================================
================================================================================
ğŸ—ï¸  Recomm_ShortInterest.py
Generating Recommendation and Short Interest predictor
================================================================================
ğŸ“Š Loading IBES Recommendations data...
Loaded IBES Recommendations: 869,760 observations
After taking mean recommendation within each stock-month: 1,268,913 observations
ğŸ“Š Loading SignalMasterTable, CRSP, and Short Interest data...
Loaded SignalMasterTable: 3,041,691 observations
SignalMasterTable merged with CRSP: 3,041,691 observations
After merging with short interest: 1,577,952 observations
After merging with recommendations: 752,347 observations
ğŸ§® Signal construction...
ğŸ“Š Computing quintiles using stata_fastxtile...
--- Signal summary ---
Signal distribution: shape: (3, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Recomm_ShortInterest â”† count  â”‚
â”‚ ---                  â”† ---    â”‚
â”‚ i32                  â”† u32    â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ null                 â”† 684290 â”‚
â”‚ 1                    â”† 44395  â”‚
â”‚ 0                    â”† 23662  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Time period:
1993-11-01 to 2024-11-01
ğŸ’¾ Saving Recomm_ShortInterest predictor...
saving Recomm_ShortInterest
Saved 68057 rows to ../pyData/Predictors/Recomm_ShortInterest.csv
âœ… Recomm_ShortInterest.csv saved successfully
============================================================
âœ… Completed: Recomm_ShortInterest.py
Execution time: 3.95 seconds


ğŸ”„ Starting: retConglomerate.py
============================================================
Starting retConglomerate predictor (rewritten from scratch)...
Loading CCMLinkingTable...
Initial crosswalk shape: (31917, 4)
tempCW shape after destring: (31917, 4)
Loading monthlyCRSP...
Initial CRSP shape: (5153763, 3)
tempCRSP shape: (5153763, 3)
Loading a_aCompustat...
Initial compustat annual shape: (302436, 4)
tempCS shape after filtering: (301611, 4)
Loading CompustatSegments...
Initial segments shape: (2766341, 5)
After stype filter: (1417450, 5)
After sales filter: (1370647, 5)
Identifying conglomerates...
After collapse: (535678, 4)
After merge with tempCS: (395692, 7)
Columns after merge: ['gvkey', 'sic2D', 'datadate', 'sales', 'fyear', 'permno', 'saleACS']
Industry count distribution:\ntempNInd
1    165266
2     88426
3     78312
4     38864
5     15375
Name: count, dtype: int64
After dropping missing Conglomerate: (232663, 11)
Conglomerate distribution:\nConglomerate
0.0    159873
1.0     72790
Name: count, dtype: int64
Calculating industry returns from stand-alones...
Stand-alone segments shape: (159873, 11)
After merge with tempCW: (191341, 14)
Columns after merge: ['gvkey', 'sic2D', 'datadate', 'sales', 'fyear', 'permno_x', 'saleACS', 'temptotalSales', 'tempCSSegmentShare', 'tempNInd', 'Conglomerate', 'permno_y', 'timeLinkStart_d', 'timeLinkEnd_d']
Valid links: 159,040 out of 191,341
After link validity filter: (159040, 14)
After duplicates drop: (158829, 3)
After merge with tempCRSP: (40264522, 5)
After year filter: (1844973, 6)
Industry returns shape: (38392, 3)
Constructing conglomerate returns signal...
Conglomerate segments shape: (72790, 11)
After dropping missing sic2DCSS: (72515, 4)
After merge with industry returns: (42080110, 6)
After year filter: (866346, 7)
Weight distribution:\ncount    864882.000000
mean          0.877280
std           0.227931
min           0.000000
25%           1.000000
50%           1.000000
75%           1.000000
max           1.000000
Name: tempweight, dtype: float64
Number of observations with weight < 1: 209516
Final result shape: (759656, 3)
Saving predictor...
saving retConglomerate
Saved 759656 rows to ../pyData/Predictors/retConglomerate.csv
retConglomerate predictor completed successfully!
============================================================
âœ… Completed: retConglomerate.py
Execution time: 5.74 seconds


ğŸ”„ Starting: ReturnSkew.py
============================================================
================================================================================
ğŸ—ï¸  ReturnSkew.py
Generating ReturnSkew predictor (skewness of daily returns)
================================================================================
ğŸ“Š Loading daily CRSP data...
Loaded CRSP: 107,662,961 daily observations

ğŸ”§ Starting signal construction...
Creating time_avail_m (year-month identifier)...
Date range: 1926-01-02 00:00:00 to 2024-12-31 00:00:00
Calculating return skewness by permno-month...
Generated 5,116,571 permno-month observations before filtering
Filtering to permno-months with >=15 observations...
After >=15 filter: 5,072,664 observations

ğŸ“ˆ Predictor summary statistics:
shape: (1, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ReturnSkew_mean â”† ReturnSkew_std â”† ReturnSkew_min â”† ReturnSkew_max â”‚
â”‚ ---             â”† ---            â”† ---            â”† ---            â”‚
â”‚ f64             â”† f64            â”† f64            â”† f64            â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ NaN             â”† NaN            â”† -4.902903      â”† 4.902903       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¾ Saving predictor...
saving ReturnSkew
Saved 4952730 rows to ../pyData/Predictors/ReturnSkew.csv

================================================================================
âœ… ReturnSkew.py completed successfully
Generated 1 predictor:
  â€¢ ReturnSkew: Return Skewness
================================================================================
============================================================
âœ… Completed: ReturnSkew.py
Execution time: 5.50 seconds


ğŸ”„ Starting: REV6.py
============================================================
Loading and processing REV6...
REV6 predictor saved successfully
============================================================
âœ… Completed: REV6.py
Execution time: 3.93 seconds


ğŸ”„ Starting: RevenueSurprise.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/nanops.py:1016: RuntimeWarning: invalid value encountered in subtract
  sqr = _ensure_numeric((avg - values) ** 2)
RevenueSurprise predictor created with 2107534 observations
============================================================
âœ… Completed: RevenueSurprise.py
Execution time: 12.24 seconds


ğŸ”„ Starting: roaq.py
============================================================
roaq: Saved 2,490,920 observations
============================================================
âœ… Completed: roaq.py
Execution time: 3.83 seconds


ğŸ”„ Starting: RoE.py
============================================================
RoE: Saved 3,530,302 observations
============================================================
âœ… Completed: RoE.py
Execution time: 3.63 seconds


ğŸ”„ Starting: sfe.py
============================================================
sfe predictor saved successfully
============================================================
âœ… Completed: sfe.py
Execution time: 21.88 seconds


ğŸ”„ Starting: ShareIss1Y.py
============================================================
Starting ShareIss1Y calculation...
After merge: 4047630 observations
ShareIss1Y calculated for 3517511 observations
Final output: 3517511 observations
ShareIss1Y.csv saved successfully
============================================================
âœ… Completed: ShareIss1Y.py
Execution time: 6.11 seconds


ğŸ”„ Starting: ShareIss5Y.py
============================================================
Starting ShareIss5Y calculation...
After merge: 4047630 observations
ShareIss5Y calculated for 2508021 observations
Final output: 2508021 observations
ShareIss5Y.csv saved successfully
============================================================
âœ… Completed: ShareIss5Y.py
Execution time: 4.84 seconds


ğŸ”„ Starting: ShareRepurchase.py
============================================================
ShareRepurchase predictor created with 3626811 observations
============================================================
âœ… Completed: ShareRepurchase.py
Execution time: 2.20 seconds


ğŸ”„ Starting: ShareVol.py
============================================================
Starting ShareVol.py...
Loading SignalMasterTable...
Loaded SignalMasterTable: 4047630 rows
Merging with monthly CRSP data...
After merge: 4047630 rows
Setting up panel data structure...
Creating lag variables for volume calculation...
Calculating ShareVol signal...
Calculated ShareVol for 1906936 observations
saving ShareVol
Saved 1661295 rows to ../pyData/Predictors/ShareVol.csv
ShareVol.py completed successfully
============================================================
âœ… Completed: ShareVol.py
Execution time: 0.86 seconds


ğŸ”„ Starting: ShortInterest.py
============================================================
Starting ShortInterest calculation...
After dropping missing gvkey: 3041691 observations
After merge with monthlyCRSP: 3041691 observations
After merge with monthlyShortInterest: 1577952 observations
ShortInterest calculated for 1577952 observations
Final output: 1577952 observations
ShortInterest.csv saved successfully
============================================================
âœ… Completed: ShortInterest.py
Execution time: 3.30 seconds


ğŸ”„ Starting: sinAlgo.py
============================================================
Starting sinAlgo.py...
Loading Compustat segments data...
Loaded segments data: 2766341 rows
Identifying sin segments...
Loading SignalMasterTable...
Loaded SignalMasterTable: 4047630 rows
Merging with Compustat annual data...
After merge: 4047630 rows
Identifying sin stocks...
Calculating sinAlgo signal...
Calculated sinAlgo for 233996 observations
saving sinAlgo
Saved 233996 rows to ../pyData/Predictors/sinAlgo.csv
sinAlgo.py completed successfully
============================================================
âœ… Completed: sinAlgo.py
Execution time: 31.04 seconds


ğŸ”„ Starting: Size.py
============================================================
/Users/chen1678/venvloc/openap/lib/python3.13/site-packages/pandas/core/arraylike.py:399: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
Size: Saved 4,029,252 observations
============================================================
âœ… Completed: Size.py
Execution time: 3.56 seconds


ğŸ”„ Starting: skew1.py
============================================================
Starting skew1.py...
skew1 predictor saved successfully
============================================================
âœ… Completed: skew1.py
Execution time: 1.22 seconds


ğŸ”„ Starting: SmileSlope.py
============================================================
saving SmileSlope
Saved 872108 rows to ../pyData/Predictors/SmileSlope.csv
============================================================
âœ… Completed: SmileSlope.py
Execution time: 2.30 seconds


ğŸ”„ Starting: SP.py
============================================================
SP: Saved 3,030,958 observations
============================================================
âœ… Completed: SP.py
Execution time: 3.37 seconds


ğŸ”„ Starting: Spinoff.py
============================================================
Spinoff predictor saved successfully
============================================================
âœ… Completed: Spinoff.py
Execution time: 2.52 seconds


ğŸ”„ Starting: std_turn.py
============================================================
Starting std_turn.py...
Loading data...
saving std_turn
Saved 2200763 rows to ../pyData/Predictors/std_turn.csv
std_turn.py completed successfully
============================================================
âœ… Completed: std_turn.py
Execution time: 1.45 seconds


ğŸ”„ Starting: STreversal.py
============================================================
Starting STreversal.py...
Loading SignalMasterTable...
Loaded data: 4047630 rows
Calculating STreversal...
Calculated STreversal for 4047630 observations
saving STreversal
Saved 4047630 rows to ../pyData/Predictors/STreversal.csv
STreversal.py completed successfully
============================================================
âœ… Completed: STreversal.py
Execution time: 0.43 seconds


ğŸ”„ Starting: SurpriseRD.py
============================================================
SurpriseRD predictor saved successfully
============================================================
âœ… Completed: SurpriseRD.py
Execution time: 2.25 seconds


ğŸ”„ Starting: tang.py
============================================================
tang: Saved 1,517,767 observations
============================================================
âœ… Completed: tang.py
Execution time: 2.96 seconds


ğŸ”„ Starting: Tax.py
============================================================
Tax: Saved 3,214,588 observations
============================================================
âœ… Completed: Tax.py
Execution time: 3.01 seconds


ğŸ”„ Starting: TotalAccruals.py
============================================================
TotalAccruals predictor saved successfully
============================================================
âœ… Completed: TotalAccruals.py
Execution time: 4.57 seconds


ğŸ”„ Starting: TrendFactor.py
============================================================
================================================================================
ğŸ—ï¸  TrendFactor.py
Generating TrendFactor predictor using daily data with moving averages
================================================================================
ğŸ“Š Loading daily CRSP data...
Daily CRSP data: 107,662,961 observations
ğŸ”„ Computing adjusted prices and time variables...
ğŸ“ˆ Computing moving averages for 11 different lags...
  Computing 3-day moving average...
  Computing 5-day moving average...
  Computing 10-day moving average...
  Computing 20-day moving average...
  Computing 50-day moving average...
  Computing 100-day moving average...
  Computing 200-day moving average...
  Computing 400-day moving average...
  Computing 600-day moving average...
  Computing 800-day moving average...
  Computing 1000-day moving average...
ğŸ“… Keeping only end-of-month observations...
Monthly data after filtering: 5,116,571 observations
ğŸ“Š Creating monthly data with future returns and moving averages for regressions
ğŸ¯ Computing size deciles based on NYSE stocks...
ğŸ” Applying filters for regression sample...
After applying filters: 2,077,306 observations
After merging moving averages: 2,076,868 observations
Preparing for cross-sectional regression...
Carefully creating fRet with left join
ğŸ”§ asreg regressions with asreg_collinear
Warning: could not process group 2024-12-01 00:00:00: No rows left after applying estimation-sample mask.
ğŸ“Š Computing 12-month rolling averages of beta coefficients...
ğŸ¯ Computing TrendFactor as the smoothed regression model predictions
Generated TrendFactor values: 2,058,241 observations
ğŸ’¾ Saving TrendFactor predictor...
saving TrendFactor
Saved 2058241 rows to ../pyData/Predictors/TrendFactor.csv
âœ… TrendFactor.csv saved successfully
ğŸ‰ TrendFactor computation completed!
============================================================
âœ… Completed: TrendFactor.py
Execution time: 140.01 seconds


ğŸ”„ Starting: UpRecomm.py
============================================================
UpRecomm predictor created with 461823 observations
============================================================
âœ… Completed: UpRecomm.py
Execution time: 1.17 seconds


ğŸ”„ Starting: VarCF.py
============================================================
Calculating rolling statistics for 29339 firms...
Rolling statistics calculation completed
VarCF predictor saved successfully
============================================================
âœ… Completed: VarCF.py
Execution time: 4.94 seconds


ğŸ”„ Starting: VolMkt.py
============================================================
Starting VolMkt.py...
Loading monthly CRSP data...
Loaded data: 5153763 rows
Calculating market value and dollar volume...
Creating 12-month rolling mean of dollar volume...
Calculated VolMkt for 5153763 observations
saving VolMkt
Saved 4361398 rows to ../pyData/Predictors/VolMkt.csv
VolMkt.py completed successfully
============================================================
âœ… Completed: VolMkt.py
Execution time: 0.66 seconds


ğŸ”„ Starting: VolSD.py
============================================================
================================================================================
ğŸ—ï¸  VolSD.py
Creating volume variance predictor using 36-month rolling standard deviation
================================================================================
ğŸ“Š Loading monthly CRSP data...
Loaded: 5,153,763 observations
ğŸ§® Computing 36-month rolling volume standard deviation...
ğŸ’¾ Saving VolSD predictor...
saving VolSD
Saved 3922399 rows to ../pyData/Predictors/VolSD.csv
âœ… VolSD.csv saved successfully
================================================================================
âœ… VolSD.py Complete
Volume variance predictor generated successfully
================================================================================
============================================================
âœ… Completed: VolSD.py
Execution time: 0.63 seconds


ğŸ”„ Starting: VolumeTrend.py
============================================================
Loading and processing VolumeTrend...
Rolling window regressions of volume on time...
Calculating 60-month rolling mean of vol...
saving VolumeTrend
Saved 3677088 rows to ../pyData/Predictors/VolumeTrend.csv
VolumeTrend predictor saved successfully
============================================================
âœ… Completed: VolumeTrend.py
Execution time: 6.39 seconds


ğŸ”„ Starting: XFIN.py
============================================================
XFIN predictor saved successfully
============================================================
âœ… Completed: XFIN.py
Execution time: 4.05 seconds


ğŸ”„ Starting: ZZ0_RealizedVol_IdioVol3F_ReturnSkew3F.py
============================================================
================================================================================
ğŸ—ï¸  ZZ0_RealizedVol_IdioVol3F_ReturnSkew3F.py
Generating RealizedVol, IdioVol3F, and ReturnSkew3F predictors
================================================================================
ğŸ“Š Loading daily CRSP and Fama-French data...
Loading dailyCRSP.parquet...
Loaded CRSP: 107,662,961 daily observations
Loading dailyFF.parquet...
Loaded FF factors: 26,066 daily observations
Merging CRSP and FF data...
Merged dataset: 107,583,998 observations
Adjusting returns by risk-free rate...

ğŸ”§ Starting signal construction...
Creating time_avail_m (year-month identifier)...
Date range: 1926-07-01 00:00:00 to 2024-12-31 00:00:00
Running FF3 regressions by permno-month to extract residuals...
Adding _Nobs to track observations used in regression...
âš ï¸  Warning: 63491 observations with missing residuals (likely singular matrices)
Completed regressions: 105,390,189 observations
Filtering out observations where FF3 regression failed (null residuals)...
After removing null residuals: 105,326,698 observations
Permno-month groups after filtering: 4,980,936
Calculating predictors using group aggregations...
Generated predictors: 4,980,936 permno-month observations

ğŸ“ˆ Predictor summary statistics:
shape: (1, 6)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RealizedVol_me â”† RealizedVol_st â”† IdioVol3F_mean â”† IdioVol3F_std â”† ReturnSkew3F_ â”† ReturnSkew3F_ â”‚
â”‚ an             â”† d              â”† ---            â”† ---           â”† mean          â”† std           â”‚
â”‚ ---            â”† ---            â”† f64            â”† f64           â”† ---           â”† ---           â”‚
â”‚ f64            â”† f64            â”†                â”†               â”† f64           â”† f64           â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 0.029741       â”† 0.031077       â”† 0.025296       â”† 0.028492      â”† NaN           â”† NaN           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¾ Saving predictors...
saving RealizedVol
Saved 4980936 rows to ../pyData/Predictors/RealizedVol.csv
saving IdioVol3F
Saved 4980936 rows to ../pyData/Predictors/IdioVol3F.csv
saving ReturnSkew3F
Saved 4969297 rows to ../pyData/Predictors/ReturnSkew3F.csv

================================================================================
âœ… ZZ0_RealizedVol_IdioVol3F_ReturnSkew3F.py completed successfully
Generated 3 predictors:
  â€¢ RealizedVol: Realized (Total) Vol (Daily)
  â€¢ IdioVol3F: Idiosyncratic Risk (3 factor)
  â€¢ ReturnSkew3F: Skewness of daily idiosyncratic returns (3F model)
================================================================================
============================================================
âœ… Completed: ZZ0_RealizedVol_IdioVol3F_ReturnSkew3F.py
Execution time: 87.86 seconds


ğŸ”„ Starting: ZZ1_Activism1_Activism2.py
============================================================
Loading SignalMasterTable...
Initial data loaded: 4047630 rows
Merging with TR_13F...
After TR_13F merge: 4047630 rows
Merging with monthlyCRSP...
After monthlyCRSP merge: 4047630 rows
Handling ticker-based merge with GovIndex...
Records with ticker: 4047630
Records without ticker: 0
After GovIndex merge and append: 4047630 rows
Constructing Activism1 signal...
Calculating block holding quartiles by time_avail_m...
Activism1 signal constructed
Non-missing Activism1 values: 108768
Constructing Activism2 signal...
Activism2 signal constructed
Non-missing Activism2 values: 30170
Saving Activism1...
saving Activism1
Saved 108768 rows to ../pyData/Predictors/Activism1.csv
Saving Activism2...
saving Activism2
Saved 30170 rows to ../pyData/Predictors/Activism2.csv
Activism1 and Activism2 predictors completed!
============================================================
âœ… Completed: ZZ1_Activism1_Activism2.py
Execution time: 3.23 seconds


ğŸ”„ Starting: ZZ1_AnalystValue_AOP_PredictedFE_IntrinsicValue.py
============================================================
================================================================================
ğŸ—ï¸  ZZ1_AnalystValue_AOP_PredictedFE_IntrinsicValue.py
Generating analyst value predictors: AnalystValue, AOP, PredictedFE. Also the placebo IntrinsicValue.
================================================================================
ğŸ“Š Preparing IBES forecast data...
Loading IBES EPS Unadj for FROE1...
FROE1 data: 183,523 observations
Loading IBES EPS Unadj for FROE2...
FROE2 data: 181,697 observations
Loading IBES EPS Unadj for LTG...
LTG data: 1,428,363 observations
ğŸ“Š Loading main data sources...
SignalMasterTable: 4,047,630 observations
After merging CRSP and Compustat: 4,047,630 observations
After filtering to June observations: 336,692 observations
After merging IBES data: 336,692 observations
ğŸ§® Computing financial variables and screens...
ğŸ“ˆ Computing forecast-based equity values...
ğŸ” Applying data screens...
After applying screens: 108,765 observations
ğŸ’° Computing analyst and intrinsic values...
ğŸ”® Computing predicted forecast error...
ğŸ“… Expanding to monthly observations...
ğŸ’¾ Saving predictors...
Generated AnalystValue: 1,301,064 observations
  Mean: 0.779304
  Std: 10.220123
saving AnalystValue
Saved 1301064 rows to ../pyData/Predictors/AnalystValue.csv
âœ… AnalystValue.csv saved successfully
Generated AOP: 1,301,064 observations
  Mean: 160.369762
  Std: 46436.956547
saving AOP
Saved 1301064 rows to ../pyData/Predictors/AOP.csv
âœ… AOP.csv saved successfully
Generated PredictedFE: 638,460 observations
  Mean: 0.052657
  Std: 0.033170
saving PredictedFE
Saved 638460 rows to ../pyData/Predictors/PredictedFE.csv
âœ… PredictedFE.csv saved successfully
saving IntrinsicValue
Saved 1301064 rows to ../pyData/Placebos/IntrinsicValue.csv
âœ… IntrinsicValue.csv saved successfully
ğŸ‰ All analyst value predictors completed!
============================================================
âœ… Completed: ZZ1_AnalystValue_AOP_PredictedFE_IntrinsicValue.py
Execution time: 1.79 seconds


ğŸ”„ Starting: ZZ1_EBM_BPEBM.py
============================================================
Starting ZZ1_EBM_BPEBM.py...
Loading data...
saving EBM
Saved 2924856 rows to ../pyData/Predictors/EBM.csv
ZZ1_EBM_BPEBM.py completed successfully
saving BPEBM
Saved 2924856 rows to ../pyData/Predictors/BPEBM.csv
ZZ1_EBM_BPEBM.py completed successfully
============================================================
âœ… Completed: ZZ1_EBM_BPEBM.py
Execution time: 1.23 seconds


ğŸ”„ Starting: ZZ1_FR_FRbook.py
============================================================
FR (Predictor) and FRbook (Placobo) saved successfully
============================================================
âœ… Completed: ZZ1_FR_FRbook.py
Execution time: 3.04 seconds


ğŸ”„ Starting: ZZ1_grcapx_grcapx1y_grcapx3y.py
============================================================
Starting ZZ1_grcapx_grcapx1y_grcapx3y.py...
Loading m_aCompustat data...
Loaded m_aCompustat: 3626811 rows, 6 columns
Removing duplicate permno-time_avail_m observations...
Removed 0 duplicate observations
Merging with SignalMasterTable...
After merge: 3041691 rows, 7 columns
Setting up panel data (sorting by permno, time_avail_m)...
Calculating FirmAge...
Calculating tempcrsptime and applying FirmAge restriction...
Creating l12_ppent lag for conditional replacement...
Applying conditional capx replacement...
Creating lags for capx after replacement...
Calculating predictors...
Calculated grcapx for 2444976 observations
Calculated grcapx1y for 2440811 observations
Calculated grcapx3y for 2236619 observations
saving grcapx
Saved 2444976 rows to ../pyData/Predictors/grcapx.csv
saving grcapx1y
Saved 2440811 rows to ../pyData/Placebos/grcapx1y.csv
saving grcapx3y
Saved 2236619 rows to ../pyData/Predictors/grcapx3y.csv
ZZ1_grcapx_grcapx1y_grcapx3y.py completed successfully
============================================================
âœ… Completed: ZZ1_grcapx_grcapx1y_grcapx3y.py
Execution time: 2.64 seconds


ğŸ”„ Starting: ZZ1_IntanBM_IntanSP_IntanCFP_IntanEP.py
============================================================
Starting ZZ1_IntanBM_IntanSP_IntanCFP_IntanEP.py
Loading data...
Data loaded. Shape: (3041691, 10)
Constructing signals...
Calculating cumulative returns...
Calculating 60-month calendar-based lag for cumulative returns...
Processing tempAccBM...
  Calculating 60-month calendar-based lag for tempAccBM...
Processing tempAccSP...
  Calculating 60-month calendar-based lag for tempAccSP...
Processing tempAccCFP...
  Calculating 60-month calendar-based lag for tempAccCFP...
Processing tempAccEP...
  Calculating 60-month calendar-based lag for tempAccEP...
Regressions completed.
Saving IntanBM...
Saved IntanBM with 1728573 observations
Saving IntanSP...
Saved IntanSP with 1876808 observations
Saving IntanCFP...
Saved IntanCFP with 1881252 observations
Saving IntanEP...
Saved IntanEP with 1881252 observations
ZZ1_IntanBM_IntanSP_IntanCFP_IntanEP.py completed successfully!
============================================================
âœ… Completed: ZZ1_IntanBM_IntanSP_IntanCFP_IntanEP.py
Execution time: 29.80 seconds


ğŸ”„ Starting: ZZ1_iomom_cust__iomom_supp.py
============================================================
2025-10-14 12:47:13,206 - INFO - Starting InputOutputMomentum processing using R script...
2025-10-14 12:47:13,206 - INFO - Calling R script...
2025-10-14 12:47:29,005 - INFO - R script completed successfully
2025-10-14 12:47:29,005 - INFO - R output: [1] "Loading input data..."
[1] "Checking for BEA Input-Output tables..."
[1] "âœ“ All BEA Input-Output tables found"
[1] "Calculating customer momentum..."
[1] "checking stock assignments:"
# A tibble: 12 Ã— 5
   port    mean   vol nmonths tstat
   <chr>  <dbl> <dbl>   <int> <dbl>
 1 port1  0.628  6.31     240  1.54
 2 port10 1.51   5.83     240  4.02
 3 port2  1.20   6.04     240  3.06
 4 port3  0.942  6.46     240  2.26
 5 port4  1.00   6.17     240  2.52
 6 port5  1.27   5.94     240  3.30
 7 port6  1.41   6.14     240  3.57
 8 port7  1.26   5.88     240  3.33
 9 port8  1.47   5.98     240  3.82
10 port9  1.34   6.17     240  3.37
11 portLS 0.885  4.60     240  2.98
12 portNA 2.87  14.9      240  2.98
[1] "Calculating supplier momentum..."
[1] "checking stock assignments:"
# A tibble: 12 Ã— 5
   port    mean   vol nmonths tstat
   <chr>  <dbl> <dbl>   <int> <dbl>
 1 port1  0.979  5.55     240  2.73
 2 port10 1.27   5.54     240  3.56
 3 port2  0.795  6.22     240  1.98
 4 port3  1.26   6.26     240  3.11
 5 port4  1.04   6.20     240  2.59
 6 port5  1.21   6.42     240  2.92
 7 port6  1.51   5.95     240  3.94
 8 port7  1.51   6.72     240  3.48
 9 port8  1.33   6.21     240  3.33
10 port9  1.43   6.09     240  3.63
11 portLS 0.294  4.28     240  1.06
12 portNA 3.54  18.6      240  2.95
[1] "Combining and saving results..."
[1] "Successfully saved output to: /Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyData/Intermediate/InputOutputMomentum_R.csv"
[1] "Total rows: 5661496"

2025-10-14 12:47:29,005 - INFO - Reading R script output...
2025-10-14 12:47:30,237 - INFO - Loaded R script output: 5,661,496 rows
2025-10-14 12:47:30,237 - INFO - Applying Stata post-processing...
2025-10-14 12:47:30,973 - INFO - After time_avail_m creation: 5,661,496 rows
2025-10-14 12:47:31,721 - INFO - After collapse: 5,661,232 rows
2025-10-14 12:47:32,583 - INFO - After pivot to wide: 2,906,580 rows
2025-10-14 12:47:32,792 - INFO - Successfully saved 2,906,580 rows to ../pyData/Intermediate/InputOutputMomentumProcessed.parquet
2025-10-14 12:47:32,792 - INFO - InputOutputMomentum processing completed successfully!
2025-10-14 12:47:32,792 - INFO - Sample data:
2025-10-14 12:47:32,794 - INFO -    gvkey time_avail_m  retmatchcustomer  portindcustomer  retmatchsupplier  portindsupplier
0   1001   1987-01-01         14.272342              3.0         13.687045              6.0
1   1001   1987-02-01         10.002191             10.0          3.580740              2.0
2   1001   1987-03-01          3.576098              4.0          3.106392              2.0
3   1001   1987-04-01         -1.612515              8.0         -4.319838              2.0
4   1001   1987-05-01          1.336602              9.0          2.021301             10.0
2025-10-14 12:47:32,794 - INFO - Summary statistics:
2025-10-14 12:47:32,811 - INFO - retmatchcustomer: mean=1.708609, std=5.969661, count=2778352
2025-10-14 12:47:32,828 - INFO - retmatchsupplier: mean=1.577126, std=5.282351, count=2882880
Starting iomom_cust and iomom_supp predictors...
Loading SignalMasterTable...
Loaded 3,041,691 observations with gvkey
Using 2,906,580 InputOutputMomentum observations
Merging with InputOutputMomentumProcessed...
After merge: 3,041,691 observations
After dropping missing iomom_cust: 1,637,593 observations
Saving iomom_cust predictor...
saving iomom_cust
Saved 1637593 rows to ../pyData/Predictors/iomom_cust.csv
After dropping missing iomom_supp: 1,639,765 observations
Saving iomom_supp predictor...
saving iomom_supp
Saved 1639765 rows to ../pyData/Predictors/iomom_supp.csv
iomom_cust and iomom_supp predictors completed successfully!
============================================================
âœ… Completed: ZZ1_iomom_cust__iomom_supp.py
Execution time: 21.02 seconds


ğŸ”„ Starting: ZZ1_OptionVolume1_OptionVolume2.py
============================================================
Starting ZZ1_OptionVolume1_OptionVolume2.py...
Loading data...
Started ZZ1_OptionVolume1_OptionVolume2.py...
saving OptionVolume1
Saved 778681 rows to ../pyData/Predictors/OptionVolume1.csv
ZZ1_OptionVolume1_OptionVolume2.py completed successfully
saving OptionVolume2
Saved 766055 rows to ../pyData/Predictors/OptionVolume2.csv
ZZ1_OptionVolume1_OptionVolume2.py completed successfully
============================================================
âœ… Completed: ZZ1_OptionVolume1_OptionVolume2.py
Execution time: 5.00 seconds


ğŸ”„ Starting: ZZ1_OrgCap_OrgCapNoAdj.py
============================================================
Loading data files...
After OrgCapNoAdj calculation: 1,614,810 non-missing values
After FF17 classification: 1,826,609 observations
Final OrgCap values: 1,249,231 non-missing
saving OrgCap
Saved 1249231 rows to ../pyData/Predictors/OrgCap.csv
saving OrgCapNoAdj
Saved 1249255 rows to ../pyData/Placebos/OrgCapNoAdj.csv
OrgCap and OrgCapNoAdj calculation completed successfully!
============================================================
âœ… Completed: ZZ1_OrgCap_OrgCapNoAdj.py
Execution time: 16.94 seconds


ğŸ”„ Starting: ZZ1_ResidualMomentum6m_ResidualMomentum.py
============================================================
================================================================================
ğŸ—ï¸  ZZ1_ResidualMomentum6m_ResidualMomentum.py
Generating ResidualMomentum6m and ResidualMomentum predictors
================================================================================
ğŸ“Š Loading monthly CRSP and Fama-French data...
Loading monthlyCRSP.parquet...
Loaded CRSP: 5,153,763 monthly observations
Loading monthlyFF.parquet...
Loaded FF factors: 1,190 monthly observations
Merging CRSP and FF data...
Merged dataset: 5,150,010 observations

ğŸ”§ Starting signal construction...
Calculating excess returns (retrf = ret - rf)...
Creating time_temp position index by permno...
Running rolling 36-observation FF3 regressions by permno using direct polars-ols helper...
Processing 38835 unique permnos...
Completed rolling regressions for 5,150,010 observations
Calculating lagged residuals and momentum signals...
Calculating 6-observation and 11-observation rolling momentum signals...

ğŸ“ˆ Signal summary statistics:
ResidualMomentum6m - Mean: -0.0597, Std: 0.5126
ResidualMomentum - Mean: -0.0383, Std: 0.3300
Non-missing ResidualMomentum6m: 3,601,799
Non-missing ResidualMomentum: 3,458,602

ğŸ’¾ Saving signals...
saving ResidualMomentum6m
Saved 3601799 rows to ../pyData/Placebos/ResidualMomentum6m.csv
saving ResidualMomentum
Saved 3458602 rows to ../pyData/Predictors/ResidualMomentum.csv

================================================================================
âœ… ZZ1_ResidualMomentum6m_ResidualMomentum.py completed successfully
Generated 2 signals:
  â€¢ ResidualMomentum6m: 6 month residual momentum (Placebo)
  â€¢ ResidualMomentum: Momentum based on FF3 residuals (Predictor)
================================================================================
============================================================
âœ… Completed: ZZ1_ResidualMomentum6m_ResidualMomentum.py
Execution time: 8.17 seconds


ğŸ”„ Starting: ZZ1_RIO_MB_RIO_Disp_RIO_Turnover_RIO_Volatility.py
============================================================
================================================================================
ğŸ—ï¸  ZZ1_RIO_MB_RIO_Disp_RIO_Turnover_RIO_Volatility.py
Generating Real Investment Opportunities (RIO) predictors
================================================================================
ğŸ“Š Preparing IBES data...
IBES EPS data: 2,401,222 observations
ğŸ“Š Loading main data sources...
SignalMasterTable: 4,047,630 observations
After merging all data sources: 4,047,630 observations
ğŸ” Applying size filters...
After filtering bottom size quintile: 2,620,059 observations
ğŸ›ï¸ Computing Residual Institutional Ownership (RIO)...
ğŸ“Š Computing characteristic variables...
ğŸ·ï¸ Creating characteristic quintiles and RIO interactions...
ğŸ’¾ Saving RIO predictors...
Generated RIO_MB: 354,478 observations
  Value distribution:
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RIO_MB â”† count â”‚
â”‚ ---    â”† ---   â”‚
â”‚ f64    â”† u32   â”‚
â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•¡
â”‚ 1.0    â”† 79109 â”‚
â”‚ 2.0    â”† 82962 â”‚
â”‚ 3.0    â”† 76271 â”‚
â”‚ 4.0    â”† 65045 â”‚
â”‚ 5.0    â”† 51091 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
saving RIO_MB
Saved 354478 rows to ../pyData/Predictors/RIO_MB.csv
âœ… RIO_MB.csv saved successfully
Generated RIO_Disp: 497,502 observations
  Value distribution:
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RIO_Disp â”† count  â”‚
â”‚ ---      â”† ---    â”‚
â”‚ f64      â”† u32    â”‚
â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1.0      â”† 42644  â”‚
â”‚ 2.0      â”† 59387  â”‚
â”‚ 3.0      â”† 106688 â”‚
â”‚ 4.0      â”† 138389 â”‚
â”‚ 5.0      â”† 150394 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
saving RIO_Disp
Saved 497502 rows to ../pyData/Predictors/RIO_Disp.csv
âœ… RIO_Disp.csv saved successfully
Generated RIO_Turnover: 445,571 observations
  Value distribution:
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RIO_Turnover â”† count  â”‚
â”‚ ---          â”† ---    â”‚
â”‚ f64          â”† u32    â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1.0          â”† 56529  â”‚
â”‚ 2.0          â”† 85651  â”‚
â”‚ 3.0          â”† 99589  â”‚
â”‚ 4.0          â”† 96332  â”‚
â”‚ 5.0          â”† 107470 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
saving RIO_Turnover
Saved 445571 rows to ../pyData/Predictors/RIO_Turnover.csv
âœ… RIO_Turnover.csv saved successfully
Generated RIO_Volatility: 470,255 observations
  Value distribution:
shape: (5, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RIO_Volatility â”† count  â”‚
â”‚ ---            â”† ---    â”‚
â”‚ f64            â”† u32    â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡
â”‚ 1.0            â”† 56810  â”‚
â”‚ 2.0            â”† 64167  â”‚
â”‚ 3.0            â”† 97959  â”‚
â”‚ 4.0            â”† 120450 â”‚
â”‚ 5.0            â”† 130869 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
saving RIO_Volatility
Saved 470255 rows to ../pyData/Predictors/RIO_Volatility.csv
âœ… RIO_Volatility.csv saved successfully
ğŸ‰ All RIO predictors completed!
============================================================
âœ… Completed: ZZ1_RIO_MB_RIO_Disp_RIO_Turnover_RIO_Volatility.py
Execution time: 32.17 seconds


ğŸ”„ Starting: ZZ1_RIVolSpread.py
============================================================
Starting ZZ1_RIVolSpread.py...
Loading data...
saving RIVolSpread
Saved 759401 rows to ../pyData/Predictors/RIVolSpread.csv
ZZ1_RIVolSpread.py completed successfully
============================================================
âœ… Completed: ZZ1_RIVolSpread.py
Execution time: 5.25 seconds


ğŸ”„ Starting: ZZ1_zerotrade_zerotradeAlt1_zerotradeAlt12.py
============================================================
Starting ZZ1_zerotrade_zerotradeAlt1_zerotradeAlt12.py...
Loading data...
============================================================
âœ… Completed: ZZ1_zerotrade_zerotradeAlt1_zerotradeAlt12.py
Execution time: 21.91 seconds


ğŸ”„ Starting: ZZ2_AbnormalAccruals_AbnormalAccrualsPercent.py
============================================================
================================================================================
ğŸ—ï¸  ZZ2_AbnormalAccruals_AbnormalAccrualsPercent.py
Generating Abnormal Accruals predictor using Xie (2001) methodology
================================================================================
ğŸ“Š Loading a_aCompustat data...
Loaded a_aCompustat: 302,436 observations
After merging with SignalMasterTable: 302,436 observations
ğŸ§® Computing abnormal accruals following Xie (2001)...
ğŸ“Š Applying winsorization at 0.1% and 99.9% levels...
ğŸ­ Running cross-sectional regressions by year and industry (SIC2)...
After cross-sectional regressions and filtering: 264,778 observations
ğŸ“… Expanding to permno-monthly observations...
ğŸ’¾ Saving AbnormalAccruals predictor...
saving AbnormalAccruals
Saved 2686345 rows to ../pyData/Predictors/AbnormalAccruals.csv
âœ… AbnormalAccruals.csv saved successfully
ğŸ’¾ Saving AbnormalAccrualsPercent predictor...
saving AbnormalAccrualsPercent
Saved 2629956 rows to ../pyData/Placebos/AbnormalAccrualsPercent.csv
âœ… AbnormalAccrualsPercent.csv saved successfully
Generated AbnormalAccruals values: 3,248,337 observations
Non-null AbnormalAccruals: 2,686,345 observations
AbnormalAccruals summary stats:
  Mean: -0.001579
  Std: 0.166390
  Min: -8.277905
  Max: 2.811868
============================================================
âœ… Completed: ZZ2_AbnormalAccruals_AbnormalAccrualsPercent.py
Execution time: 1.68 seconds


ğŸ”„ Starting: ZZ2_AnnouncementReturn.py
============================================================
Starting AnnouncementReturn calculation...
Loading CCMLinkingTable...
Loading m_QCompustat...
Loading dailyCRSP...
Merging with crosswalk...
Observations within link validity period: 84964956 out of 131268381
Merging with dailyFF...
Creating announcement windows...
Collapsing by announcement windows...
Filling missing months...
Columns after reset_index: ['index', 'AnnouncementReturn', 'permno']
Index name after reset_index: None
Final dataset shape: (2922431, 3)
Saving to pyData/Predictors/AnnouncementReturn.csv...
AnnouncementReturn calculation completed.
============================================================
âœ… Completed: ZZ2_AnnouncementReturn.py
Execution time: 77.88 seconds


ğŸ”„ Starting: ZZ2_BetaFP.py
============================================================
================================================================================
ğŸ—ï¸  ZZ2_BetaFP.py
Generating Frazzini-Pedersen beta using rolling correlations
================================================================================
ğŸ“Š Loading daily CRSP and Fama-French data...
Loaded CRSP: 107,662,961 daily observations
Loaded FF factors: 26,066 daily observations
Merged dataset: 107,583,998 observations

ğŸ”§ Starting signal construction...
Calculating excess log returns...
Computing 252-day rolling volatilities...
Creating 3-day overlapping returns...
Calculating rolling R-squared (1260-day window, min 500 obs)...
Computing Frazzini-Pedersen beta...

ğŸ“… Converting to monthly frequency...
Aggregating to permno-month level...
Generated predictors: 4,156,049 permno-month observations

ğŸ“ˆ Predictor summary statistics:
shape: (9, 2)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ statistic  â”† BetaFP     â”‚
â”‚ ---        â”† ---        â”‚
â”‚ str        â”† f64        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ count      â”† 4.156049e6 â”‚
â”‚ null_count â”† 0.0        â”‚
â”‚ mean       â”† 0.977433   â”‚
â”‚ std        â”† 0.646237   â”‚
â”‚ min        â”† 0.0        â”‚
â”‚ 25%        â”† 0.511576   â”‚
â”‚ 50%        â”† 0.891299   â”‚
â”‚ 75%        â”† 1.315577   â”‚
â”‚ max        â”† 12.5731    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¾ Saving predictor...
saving BetaFP
Saved 4156049 rows to ../pyData/Predictors/BetaFP.csv

================================================================================
âœ… ZZ2_BetaFP.py completed successfully
Generated predictor: BetaFP (Frazzini-Pedersen Beta)
================================================================================
============================================================
âœ… Completed: ZZ2_BetaFP.py
Execution time: 11.00 seconds


ğŸ”„ Starting: ZZ2_betaVIX.py
============================================================
================================================================================
ZZ2_betaVIX.py
Generating betaVIX predictor from daily market and VIX data
================================================================================
Loading daily datasets...
Loading dailyCRSP.parquet...
Loaded daily CRSP observations: 107,662,961
Loading dailyFF.parquet...
Loaded daily Fama-French observations: 26,066
Loading d_vix.parquet...
Loaded daily VIX change observations: 10,378
Merging CRSP returns with factors and VIX changes...
Combined daily panel observations: 74,667,254
Unique permnos in panel: 32,953
Running rolling 20-day regressions (min 15 obs) per permno...
Extracted betaVIX coefficients from rolling regressions
Aggregating daily coefficients to month-end values...
Monthly betaVIX rows: 3,578,515
betaVIX summary stats:
  Mean: 0.000429
  Std: 0.018985
  Min: -1.570087
  Max: 1.993005
Saving betaVIX predictor...
saving betaVIX
Saved 3553481 rows to ../pyData/Predictors/betaVIX.csv
betaVIX predictor saved
================================================================================
betaVIX pipeline complete
================================================================================
============================================================
âœ… Completed: ZZ2_betaVIX.py
Execution time: 60.94 seconds


ğŸ”„ Starting: ZZ2_IdioVolAHT.py
============================================================
/Users/chen1678/Library/CloudStorage/Dropbox/oap-ac/CrossSection/Signals/pyCode/Predictors/ZZ2_IdioVolAHT.py:272: DeprecationWarning: the argument `min_periods` for `Expr.rolling_sum` is deprecated. It was renamed to `min_samples` in version 1.21.0.
  return expr.rolling_sum(window_size, min_periods=min_samples).over(over)
Starting ZZ2_IdioVolAHT.py...
Loading daily CRSP and Fama-French data...
Daily CRSP data: 107662961 rows
Merging with Fama-French factors...
After merge: 107583998 rows
Running 252-day rolling CAPM regressions...
Calculating idiosyncratic volatility...
Calculated IdioVolAHT for 5030419 observations
saving IdioVolAHT
Saved 4849170 rows to ../pyData/Predictors/IdioVolAHT.csv
ZZ2_IdioVolAHT.py completed successfully
============================================================
âœ… Completed: ZZ2_IdioVolAHT.py
Execution time: 89.84 seconds


ğŸ”„ Starting: ZZ2_PriceDelaySlope_PriceDelayRsq_PriceDelayTstat.py
============================================================
================================================================================
ğŸ—ï¸  ZZ2_PriceDelaySlope_PriceDelayRsq_PriceDelayTstat.py
Generating price delay predictors using daily data regressions
================================================================================
ğŸ“Š Preparing daily Fama-French data with lags...
Daily FF data with 4 lags: 26,066 observations
ğŸ“Š Loading daily CRSP data...
Daily CRSP data: 107,662,961 observations
After merging and adjusting returns: 107,583,998 observations

ğŸ“Š FULL DATASET MODE: Processing all permnos
ğŸ“… Setting up time variables for June regressions...
ğŸƒ Running regressions by group...
  Filtering groups with minimum 26 observations and data quality checks...
Groups before quality filtering: 461,455
Groups after quality filtering: 448,725
  Filtered out 12,730 groups with data quality issues
ğŸš€ Processing all valid groups
After filtering for minimum observations and data quality: 106,063,821 observations
  Running regressions (one per group)...
  Running restricted regressions on 448,725 groups...
  Running unrestricted regressions on 448,725 groups...
ğŸ“Š Extracting coefficients and R-squared values...
ğŸ“… Filtering for valid results and June endpoints...
Monthly data after filtering: 415,485 observations
ğŸ¯ Constructing price delay signals...
ğŸ“Š Applying winsorization and time adjustment...
ğŸ“… Forward-filling to monthly frequency...
  Calculated values: 415,485 observations
  Creating complete time series per permno...
  Processing 37574 permnos...
    Processing batch 1/376...
    Processing batch 11/376...
    Processing batch 21/376...
    Processing batch 31/376...
    Processing batch 41/376...
    Processing batch 51/376...
    Processing batch 61/376...
    Processing batch 71/376...
    Processing batch 81/376...
    Processing batch 91/376...
    Processing batch 101/376...
    Processing batch 111/376...
    Processing batch 121/376...
    Processing batch 131/376...
    Processing batch 141/376...
    Processing batch 151/376...
    Processing batch 161/376...
    Processing batch 171/376...
    Processing batch 181/376...
    Processing batch 191/376...
    Processing batch 201/376...
    Processing batch 211/376...
    Processing batch 221/376...
    Processing batch 231/376...
    Processing batch 241/376...
    Processing batch 251/376...
    Processing batch 261/376...
    Processing batch 271/376...
    Processing batch 281/376...
    Processing batch 291/376...
    Processing batch 301/376...
    Processing batch 311/376...
    Processing batch 321/376...
    Processing batch 331/376...
    Processing batch 341/376...
    Processing batch 351/376...
    Processing batch 361/376...
    Processing batch 371/376...
  Complete grid after tsfill: 4,636,622 observations
  Forward-filling missing values within each permno...
  After forward-filling: 4,636,622 observations
ğŸ’¾ Saving price delay predictors...
Generated PriceDelaySlope: 4,636,622 observations
  Mean: 1.245503
  Std: 288.133659
saving PriceDelaySlope
Saved 4636622 rows to ../pyData/Predictors/PriceDelaySlope.csv
âœ… PriceDelaySlope.csv saved successfully
Generated PriceDelayRsq: 4,636,622 observations
  Mean: 0.364061
  Std: 0.327509
saving PriceDelayRsq
Saved 4636622 rows to ../pyData/Predictors/PriceDelayRsq.csv
âœ… PriceDelayRsq.csv saved successfully
Generated PriceDelayTstat: 4,636,622 observations
  Mean: -0.200005
  Std: 507.319043
saving PriceDelayTstat
Saved 4636622 rows to ../pyData/Predictors/PriceDelayTstat.csv
âœ… PriceDelayTstat.csv saved successfully
ğŸ‰ All price delay predictors completed!
============================================================
âœ… Completed: ZZ2_PriceDelaySlope_PriceDelayRsq_PriceDelayTstat.py
Execution time: 196.19 seconds

Log completed at 2025-10-14 12:56:20