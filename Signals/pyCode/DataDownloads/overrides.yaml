# Manual Overrides for Validation Failures
# 
# This file allows manual approval of validation failures with auditable paper trails.
# Each override should include justification and reviewer information.
#
# Structure:
#   dataset_name:
#     - check: [check_name]              # Required: name of the validation check
#       status: accepted|rejected          # Required: approval decision
#       reviewed_on: YYYY-MM-DD          # Required: date of review  
#       reviewed_by: [reviewer_id]       # Required: who reviewed this
#       details: |                       # Required: justification
#         Multi-line explanation of the decision
#       max_ratio_allowed: X.XX%         # Optional: custom threshold for accepted ratio checks
#
# Supported checks for DataDownloads (test_dl.py):
#   - missing_rows: Python missing some Stata rows
#   - imperfect_rows: High imperfect rows ratio
#   - imperfect_cells: High imperfect cells ratio
#   - column_names: Column names don't match
#   - column_types: Column types don't match
#
# Supported checks for Predictors (test_predictors.py):
#   - superset_check: Python observations not superset of Stata
#   - precision_check: Pth percentile absolute difference too high
#   - column_names: Column names don't match

# Example entries (remove these when adding real overrides):
#
# ExampleDataset:
#   - check: missing_rows
#     status: accepted
#     reviewed_on: 2025-07-16
#     reviewed_by: reviewer_id
#     details: |
#       Explanation of why this failure is acceptable
#
#   - check: imperfect_rows
#     status: rejected
#     reviewed_on: 2025-07-16
#     reviewed_by: reviewer_id
#     details: |
#       This failure indicates a real data quality issue that needs to be fixed.
#       The validation failure should remain until the underlying problem is resolved.

CompustatAnnual:
  - check: missing_rows
    status: accepted
    reviewed_on: 2025-07-17
    reviewed_by: ac
    details: |
      The 4 missing rows are now gone from Compustat. The missing rows are for gvkeys 022371, 029251, 036153, 038001, with datadates that are one year before the first available datadate in the updated Compustat data. They're also almost entirely missing accounting numbers. Seems like Compustat cleaned it up.
  - check: imperfect_rows
    status: accepted
    reviewed_on: 2025-07-17
    reviewed_by: ac
    details: |
      The deviations seem to be all real changes in the data, with the python data more up to date. Imperfect rows for accounting numbers are rare: ebitda has 0.018% imperfect. Still, the revisions are surprising given that only a few weeks went by between the Stata and Python data pulls, and some revisions are notable. 
      
      For example, ajex (adjustment factor to deal with splits for per share variables) for Interactive Brokers (gvkey 176701) went from 1.0 to 4.0 for for many observations. This ajex revisions may be an artifact of share adjustment methods, which may backfill to adjust for the current shares outstanding. 

      Revisions for ebitda are concentrated in recent data, typically 2024 Q4 or 2025 Q1. Still, it's interesting to see the revisions can be non-negligible. Sony (gvkey 009818) had 2025 Q1 ebitda revised up 13% during the few weeks that went by between the Stata and Python data pulls. 

      This is TMI, but I just want to be thorough before accepting.
  - check: imperfect_cells
    status: accepted
    reviewed_on: 2025-07-17
    reviewed_by: ac
    details: |
      See imperfect_rows details

a_aCompustat:
  - check: imperfect_rows
    status: accepted
    reviewed_on: 2025-07-17
    reviewed_by: ac
    details: |
      See CompustatAnnual imperfect_rows details.

m_aCompustat:
  - check: imperfect_rows
    status: accepted
    reviewed_on: 2025-07-17
    reviewed_by: ac
    details: |
      See CompustatAnnual imperfect_rows details.      